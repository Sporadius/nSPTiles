/* nSPTiles | https://github.com/imthenachoman/nSPTiles | Copyright (c) 2015 Anchal Nigam | MIT license (http://opensource.org/licenses/mit) */
var nSPTiles=nSPTiles||(function(){var ba=location.protocol+"//"+location.hostname+(_spPageContextInfo.webServerRelativeUrl==="/"?"":_spPageContextInfo.webServerRelativeUrl)+"/";var bb=250;var bc="nSPTiles";var bd=".nTilesWrapper,.nTilesContainer,.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{margin:0;padding:0;overflow:hidden}.nTilesWrapper{position:relative}.nTilesContainer{position:relative;display:inline-block}.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{position:absolute;top:0;left:0;bottom:0;right:0}.nTilePositionTable{position:absolute;display:table;width:100%;height:100%}.nTilePositionRow{display:table-row}.nTilePositionCell{display:table-cell;width:100%;height:100%}.nHoverOption1,.nTileHovering .nHoverOption2{display:inline-block!important}.nHoverOption2,.nTileHovering .nHoverOption1{display:none!important}.nTileSliderContent{position:absolute;height:100%;width:100%}.nTileLink{cursor:pointer}.nTileAdminLinks{position:absolute;top:0;right:0;padding:5px;display:none;z-index:50;background-color:#ff9;border:1px solid #000;filter:alpha(opacity=30);opacity:.3}.nTilesWrapper:hover .nTileAdminLinks{display:inline-block}.nTileAdminLinks:hover{filter:(alpha=100);opacity:1}.nTileGridBox{position:absolute;filter:alpha(opacity=30);opacity:.3;background-color:#ff0;z-index:100;top:0;left:0}.nTileGridBox.clicked{background-color:blue}.nTileOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0f0;filter:alpha(opacity=10);opacity:.1;z-index:95}#nTilesHelp{position:fixed;top:10px;left:10px;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}#nTilesToolTip{font-family:'Lucida Console';position:fixed;top:0;left:0;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}.nTileHoverBox{position:absolute;top:0;left:0;width:100%;height:100%;z-index:50;background-color:#ff0;filter:alpha(opacity=50);opacity:.5}.nTileFocus .nTileHoverBox{background-color:#0ff;font-weight:700;text-decoration:underline}";var be=[{"DisplayName":"active","Type":"Boolean","Description":"can be used hide a tile without having to remove this entry","Default":"1"},{"DisplayName":"tile custom ID","Type":"Text","Description":"custom ID to use for the tile &#xD;&#xA;&#xD;&#xA;default is nTile_[ID] where ID is the ID of the entry in the list","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile custom class(es)","Type":"Text","Description":"custom class(s) to add to the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile width on grid","Type":"Number","Description":"the number of horizontal grid boxes","Required":"TRUE","Min":"0","Default":"2","Validation":{"Message":"Please enter a number greater than 0.","Function":"=[tile width on grid]&gt;0"}},{"DisplayName":"tile height on grid","Type":"Number","Description":"the number of vertical grid boxes","Required":"TRUE","Min":"0","Default":"2","Validation":{"Message":"Please enter a number greater than 0.","Function":"=[tile height on grid]&gt;0"}},{"DisplayName":"tile left offset","Type":"Number","Description":"number of grid boxes over from the right (0 = first column)","Required":"TRUE","Min":"0","Default":"0"},{"DisplayName":"tile top offset","Type":"Number","Description":"number of grid boxes down from the top (0 = first row)","Required":"TRUE","Min":"0","Default":"0"},{"DisplayName":"tile border width","Type":"Number","Description":"the empty space around the tile in px","Required":"TRUE","Min":"0","Decimals":"0","Default":"2"},{"DisplayName":"tile zoom on hover","Type":"Boolean","Description":"zoom effect for the tile by making the tile border width 0 when the mouse is over the tile","Required":"FALSE","Default":"1"},{"DisplayName":"tile background color","Type":"Text","Description":"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)","Required":"FALSE","Default":"rgb(0,114,198)","MaxLength":"255"},{"DisplayName":"tile background opacity","Type":"Choice","Description":"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Default":"none","Choices":100},{"DisplayName":"tile background color on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile background opacity on hover","Type":"Choice","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"tile image URL","Type":"Text","Description":"URL of image to use in tile (must be less then 255 characters)","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile image opacity","Type":"Choice","Description":"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"tile image URL on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile image opacity on hover","Type":"Choice","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"tile image position","Type":"Choice","Description":"position of the image in the tile","Required":"TRUE","Format":"Dropdown","FillInChoice":"FALSE","Default":"top left","Choices":"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{"DisplayName":"tile image width","Type":"Text","Description":"width of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon","Required":"FALSE","MaxLength":"255","Validation":{"Message":"Please enter a whole number or a percent.","Function":'=OR([tile image width]="",AND(ISNUMBER([tile image width]+0),ROUND([tile image width]+0,0)=([tile image width]+0)),AND(RIGHT([tile image width],1)="%",ISNUMBER(LEFT([tile image width],LEN([tile image width])-1)+0)))'}},{"DisplayName":"tile image height","Type":"Text","Description":"height of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon","Required":"FALSE","MaxLength":"255","Validation":{"Message":"Please enter a whole number or a percent.","Function":'=OR([tile image height]="",AND(ISNUMBER([tile image height]+0),ROUND([tile image height]+0,0)=([tile image height]+0)),AND(RIGHT([tile image height],1)="%",ISNUMBER(LEFT([tile image height],LEN([tile image height])-1)+0)))'}},{"DisplayName":"tile image padding","Type":"Number","Description":"how far from the edge of the tile should the image be in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"5"},{"DisplayName":"tile FA class","Type":"Text","Description":"Font Awesome icon class name","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile FA style","Type":"Text","Description":"css style to apply to the FA icon","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile FA opacity","Type":"Choice","Description":"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"tile FA class on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile FA style on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"tile FA opacity on hover","Type":"Choice","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"tile FA position","Type":"Choice","Description":"position of the icon in the tile","Required":"TRUE","Format":"Dropdown","FillInChoice":"FALSE","Default":"top left","Choices":"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{"DisplayName":"tile FA padding","Type":"Number","Description":"how far from the edge of the tile should the icon be in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"5"},{"DisplayName":"tile link type","Type":"Choice","Description":"the type of link to make","Required":"TRUE  ","Format":"Dropdown","FillInChoice":"FALSE","Default":"none","Choices":"none,current window,new window,dialog,dialog (refresh window after save),dialog (refresh tiles after save)"},{"DisplayName":"tile Link URL","Type":"Note","Description":"the URL for the link","Required":"FALSE","NumLines":"3","RichText":"FALSE"},{"DisplayName":"is heading","Type":"Boolean","Description":"heading tiles have no slider","Default":"0"},{"DisplayName":"heading content","Type":"Text","Description":"can use HTML","Required":"FALSE","Default":"heading","MaxLength":"255"},{"DisplayName":"heading font color","Type":"Text","Description":"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)","Required":"FALSE","Default":"white","MaxLength":"255"},{"DisplayName":"heading content on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"heading font color on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"heading position","Type":"Choice","Description":"position of the heading in the tile or slider heading","Required":"TRUE","Format":"Dropdown","FillInChoice":"FALSE","Default":"bottom left","Choices":"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{"DisplayName":"heading padding","Type":"Number","Description":"padding for the heading in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"5"},{"DisplayName":"heading font size","Type":"Number","Description":"font size for the heading in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"10"},{"DisplayName":"bold heading","Type":"Boolean","Description":"should the heading text be bold","Default":"1"},{"DisplayName":"heading style","Type":"Text","Description":"css style to apply to heading","Required":"FALSE","MaxLength":"255"},{"DisplayName":"slider heading height","Type":"Number","Description":"height of the header for the slider in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"25"},{"DisplayName":"slider body content","Type":"Note","Description":"can use HTML","Required":"FALSE","NumLines":"5","Default":"body","RichText":"FALSE"},{"DisplayName":"slider body position","Type":"Choice","Description":"position of the slider body in the slider","Required":"TRUE","Format":"Dropdown","FillInChoice":"FALSE","Default":"top left","Choices":"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{"DisplayName":"slider body padding","Type":"Number","Description":"padding of the slider body in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"5"},{"DisplayName":"slider body font size","Type":"Number","Description":"font size for the slider body in px","Required":"FALSE","Min":"0","Decimals":"0","Default":"10"},{"DisplayName":"slider body font color","Type":"Text","Description":"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)","Required":"FALSE","Default":"white","MaxLength":"255"},{"DisplayName":"slider body style","Type":"Text","Description":"css style to apply to slider body","Required":"FALSE","MaxLength":"255"},{"DisplayName":"slider background color","Type":"Text","Description":"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)","Required":"FALSE","Default":"black","MaxLength":"255"},{"DisplayName":"slider background opacity","Type":"Choice","Description":"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Default":"50","Choices":100},{"DisplayName":"slider background color on hover","Type":"Text","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","MaxLength":"255"},{"DisplayName":"slider background opacity on hover","Type":"Choice","Description":"same as above but for when the mouse is over the tile","Required":"FALSE","Format":"Dropdown","FillInChoice":"FALSE","Choices":100},{"DisplayName":"cc tile right edge","Type":"Calculated","ResultType":"Number","Decimals":"0","Formula":"=[tile left offset]+[tile width on grid]"},{"DisplayName":"cc tile bottom edge","Type":"Calculated","ResultType":"Number","Decimals":"0","Formula":"=[tile top offset]+[tile height on grid]"},{"DisplayName":"cc tile background class","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile background color]&lt;&gt;"","nTileBackground"&amp;IF([tile background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([tile background color],1)="."," "&amp;REPLACE([tile background color],1,1,""),""),"")'},{"DisplayName":"cc tile background style","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile background color]&lt;&gt;"",IF(AND([tile background opacity]&lt;&gt;"",[tile background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity]&amp;"); opacity: "&amp;[tile background opacity]/100&amp;"; ","")&amp;IF(AND([tile background color]&lt;&gt;"",LEFT([tile background color],1)&lt;&gt;"."),"background-color: "&amp;[tile background color]&amp;"; ",""),"")'},{"DisplayName":"cc tile background class on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([tile background color on hover],1)="."," "&amp;REPLACE([tile background color on hover],1,1,""),""),"")'},{"DisplayName":"cc tile background style on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),IF(AND([tile background opacity on hover]&lt;&gt;"",[tile background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity on hover]&amp;"); opacity: "&amp;[tile background opacity on hover]/100&amp;"; ","")&amp;IF(AND([tile background color on hover]&lt;&gt;"",LEFT([tile background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[tile background color on hover]&amp;"; ",""),"")'},{"DisplayName":"cc tile image position style","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile image URL]&lt;&gt;"","vertical-align: "&amp;LEFT([tile image position],SEARCH(" ",[tile image position])-1)&amp;"; text-align: "&amp;RIGHT([tile image position],LEN([tile image position])-SEARCH(" ",[tile image position])),"")'},{"DisplayName":"cc tile image class","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile image URL]&lt;&gt;"","nTileImage"&amp;IF([tile image URL on hover]&lt;&gt;""," nHoverOption1",""),"")'},{"DisplayName":"cc tile image style","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile image URL]&lt;&gt;"",IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity]&lt;&gt;"",[tile image opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity]&amp;"); opacity: "&amp;[tile image opacity]/100&amp;"; ",""),"")'},{"DisplayName":"cc tile image class on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),"nTileImage nHoverOption2","")'},{"DisplayName":"cc tile image style on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity on hover]&lt;&gt;"",[tile image opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity on hover]&amp;"); opacity: "&amp;[tile image opacity on hover]/100&amp;"; ",""),"")'},{"DisplayName":"cc tile FA position style","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile FA class]&lt;&gt;"","vertical-align: "&amp;LEFT([tile FA position],SEARCH(" ",[tile FA position])-1)&amp;"; text-align: "&amp;RIGHT([tile FA position],LEN([tile FA position])-SEARCH(" ",[tile FA position])),"")'},{"DisplayName":"cc tile FA class","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile FA class]&lt;&gt;"","nTileFA fa "&amp;[tile FA class]&amp;IF([tile FA class on hover]&lt;&gt;""," nHoverOption1",""),"")'},{"DisplayName":"cc tile FA style","Type":"Calculated","ResultType":"Text","Formula":'=IF([tile FA class]&lt;&gt;"",[tile FA style]&amp;"; "&amp;IF(AND([tile FA opacity]&lt;&gt;"",[tile FA opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity]&amp;"); opacity: "&amp;[tile FA opacity]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px",""),"")'},{"DisplayName":"cc tile FA class on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),"nTileFA fa "&amp;[tile FA class on hover]&amp;" nHoverOption2","")'},{"DisplayName":"cc tile FA style on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),[tile FA style on hover]&amp;"; "&amp;IF(AND([tile FA opacity on hover]&lt;&gt;"",[tile FA opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity on hover]&amp;"); opacity: "&amp;[tile FA opacity on hover]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px",""),"")'},{"DisplayName":"cc heading position style","Type":"Calculated","ResultType":"Text","Formula":'=IF([heading content]&lt;&gt;"","vertical-align: "&amp;LEFT([heading position],SEARCH(" ",[heading position])-1)&amp;"; text-align: "&amp;RIGHT([heading position],LEN([heading position])-SEARCH(" ",[heading position]))&amp;"; "&amp;IF(NOT([is heading]),"height: "&amp;[slider heading height]&amp;"px; ",""),"")'},{"DisplayName":"cc heading class","Type":"Calculated","ResultType":"Text","Formula":'=IF([heading content]&lt;&gt;"","nTileHeading"&amp;IF([heading content on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([heading font color])="."," "&amp;REPLACE([heading font color],1,1,""),""),"")'},{"DisplayName":"cc heading style","Type":"Calculated","ResultType":"Text","Formula":'=IF([heading content]&lt;&gt;"",[heading style]&amp;"; "&amp;IF([bold heading],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color]&lt;&gt;"",LEFT([heading font color],1)&lt;&gt;"."),"color: "&amp;[heading font color]&amp;"; ",""),"")'},{"DisplayName":"cc heading class on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),"nTileHeading nHoverOption2"&amp;IF(LEFT([heading font color on hover])="."," "&amp;REPLACE([heading font color on hover],1,1,""),""),"")'},{"DisplayName":"cc heading style on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),[heading style]&amp;"; "&amp;IF([bold heading],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color on hover]&lt;&gt;"",LEFT([heading font color on hover],1)&lt;&gt;"."),"color: "&amp;[heading font color on hover]&amp;"; ",""),"")'},{"DisplayName":"cc slider position style","Type":"Calculated","ResultType":"Text","Formula":'=IF(NOT([is heading]),"vertical-align: "&amp;LEFT([slider body position],SEARCH(" ",[slider body position])-1)&amp;"; text-align: "&amp;RIGHT([slider body position],LEN([slider body position])-SEARCH(" ",[slider body position]))&amp;"; ","")'},{"DisplayName":"cc slider body class","Type":"Calculated","ResultType":"Text","Formula":'=IF(NOT([is heading]),"nTileSlider"&amp;IF(LEFT([slider body font color],1)="."," "&amp;REPLACE([slider body font color],1,1,""),""),"")'},{"DisplayName":"cc slider body style","Type":"Calculated","ResultType":"Text","Formula":'=IF(NOT([is heading]),[slider body style]&amp;"; "&amp;IF([slider body padding]&lt;&gt;"","padding: "&amp;[slider body padding]&amp;"px; ","")&amp;IF([slider body font size]&lt;&gt;"","font-size: "&amp;[slider body font size]&amp;"px; ","")&amp;IF(AND([slider body font color]&lt;&gt;"",LEFT([slider body font color],1)&lt;&gt;"."),"color: "&amp;[slider body font color]&amp;"; ",""),"")'},{"DisplayName":"cc slider background class","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),"nTileBackground"&amp;IF([slider background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([slider background color],1)="."," "&amp;REPLACE([slider background color],1,1,""),""),"")'},{"DisplayName":"cc slider background style","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),IF(AND([slider background opacity]&lt;&gt;"",[slider background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity]&amp;"); opacity: "&amp;[slider background opacity]/100&amp;"; ","")&amp;IF(AND([slider background color]&lt;&gt;"",LEFT([slider background color],1)&lt;&gt;"."),"background-color: "&amp;[slider background color]&amp;"; ",""),"")'},{"DisplayName":"cc slider background class on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([slider background color on hover],1)="."," "&amp;REPLACE([slider background color on hover],1,1,""),""),"")'},{"DisplayName":"cc slider background style on hover","Type":"Calculated","ResultType":"Text","Formula":'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),IF(AND([slider background opacity on hover]&lt;&gt;"",[slider background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity on hover]&amp;"); opacity: "&amp;[slider background opacity on hover]/100&amp;"; ","")&amp;IF(AND([slider background color on hover]&lt;&gt;"",LEFT([slider background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[slider background color on hover]&amp;"; ",""),"")'}];var bf={};var bg={};var bh=function(){};var bi=function(a){a.parentNode.removeChild(a)};var bj=(function(){var h=0,animationIDTracker={},lastTime=0,vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame']}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(a,b){var c=new Date().getTime();var d=Math.max(0,16-(c-lastTime));var e=window.setTimeout(function(){a(c+d)},d);lastTime=c+d;return e};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(a){clearTimeout(a)};var i={one:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},two:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b}}}return{"stop":function(a){cancelAnimationFrame(animationIDTracker[a]);delete animationIDTracker[a]},"start":function(b,c,d){var e=h++;var f=+new Date();var g=function(){var a=+new Date()-f;if(a>=b){c(1);bj.stop(e)}else{c(i[d?"one":"two"](a,0,1,b));animationIDTracker[e]=requestAnimationFrame(g)}};g();return e}}})();var bk=function(a,b,c,d){var e=document.createElement(a);if(c)e.className=c;if(d){for(attribute in d){if(/^(inner|on)\w+$/i.test(attribute))e[attribute]=d[attribute];else e.setAttribute(attribute,d[attribute])}}if(b)b.appendChild(e);return e};var bl=function(a,b,c,d,e){var f=typeof XMLHttpRequest!='undefined'?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');f.open("post",ba+"_vti_bin/"+a,typeof(e)!=="undefined"&&e!==null?e:false);f.setRequestHeader("SOAPAction",b);f.setRequestHeader("Content-Type","text/xml; charset=\"utf-8\"");f.onreadystatechange=function(){if(f.readyState==4){d(f.status==200,f)}};f.send('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>'+c+'</soap:Body></soap:Envelope>')};var bm=function(a,b,c){var d=a.getElementsByTagName(b)if(!d.length)d=a.getElementsByTagName(c+":"+b);return d};var bn=function(e,a){var c={"e":e||window.event,"pageX":0,"pageY":0,"elementX":0,"elementY":0};if(c.e.pageX||c.e.pageY){c.pageX=c.e.pageX;c.pageY=c.e.pageY}else if(c.e.clientX||c.e.clientY){c.pageX=c.e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c.pageY=c.e.clientY+document.body.scrollTop+document.documentElement.scrollTop}if(a){var b=a.getBoundingClientRect();c.elementX=c.pageX-b.left;c.elementY=c.pageY-b.top}return c};var bo=function(a,b,c,d,e){var f='<div class="nTilePositionTable '+a+'">';f+='<div class="nTilePositionRow nTilePositionRow1"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+b+';">'+c+'</div></div>';if(d){f+='<div class="nTilePositionRow nTilePositionRow2"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+d+'">'+e+'</div></div>'}return f+'</div>'};var bp=function(bq,br,bs){var bO=bg[bq];bO.tiles={};var bP=bO.tilesWrapper;var bQ=bP.querySelector(".nTilesContainer");var bR=bQ.querySelectorAll(".nTile");for(var i=0,num=bR.length;i<num;++i){bR[i].onclick=null;bR[i].onmouseenter=null;bR[i].onmouseleave=null}bQ.innerText="Please wait while I reload the data...";var bS='';bS+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';bS+='<listName>'+bc+'</listName>';bS+='<query><Query><Where><And><Eq><FieldRef Name="Title"/><Value Type="Text">'+bO.groupName+'</Value></Eq><Eq><FieldRef Name="nActive"/><Value Type="Boolean">1</Value></Eq></And></Where></Query></query>';bS+='<viewFields><ViewFields><FieldRef Name="ID" /><FieldRef Name="nTileWidthOnGrid" /><FieldRef Name="nTileHeightOnGrid" /><FieldRef Name="nTileLeftOffset" /><FieldRef Name="nTileTopOffset" /><FieldRef Name="nCcTileBottomEdge" /><FieldRef Name="nCcTileRightEdge" /><FieldRef Name="nTileBorderWidth" /><FieldRef Name="nTileZoomOnHover" /><FieldRef Name="nTileLinkType" /><FieldRef Name="nTileLinkURL" /><FieldRef Name="nTileImageURL" /><FieldRef Name="nTileImageURLOnHover" /><FieldRef Name="nIsHeading" /><FieldRef Name="nHeadingContent" /><FieldRef Name="nHeadingContentOnHover" /><FieldRef Name="nSliderHeadingHeight" /><FieldRef Name="nSliderBodyContent" /><FieldRef Name="nCcTileBackgroundClass" /><FieldRef Name="nCcTileBackgroundStyle" /><FieldRef Name="nCcTileBackgroundClassOnHover" /><FieldRef Name="nCcTileBackgroundStyleOnHover" /><FieldRef Name="nCcTileImagePositionStyle" /><FieldRef Name="nCcTileImageClass" /><FieldRef Name="nCcTileImageStyle" /><FieldRef Name="nCcTileImageClassOnHover" /><FieldRef Name="nCcTileImageStyleOnHover" /><FieldRef Name="nCcTileFAPositionStyle" /><FieldRef Name="nCcTileFAClass" /><FieldRef Name="nCcTileFAStyle" /><FieldRef Name="nCcTileFAClassOnHover" /><FieldRef Name="nCcTileFAStyleOnHover" /><FieldRef Name="nCcHeadingPositionStyle" /><FieldRef Name="nCcHeadingClass" /><FieldRef Name="nCcHeadingStyle" /><FieldRef Name="nCcHeadingClassOnHover" /><FieldRef Name="nCcHeadingStyleOnHover" /><FieldRef Name="nCcSliderBackgroundClass" /><FieldRef Name="nCcSliderBackgroundStyle" /><FieldRef Name="nCcSliderBackgroundClassOnHover" /><FieldRef Name="nCcSliderBackgroundStyleOnHover" /><FieldRef Name="nCcSliderPositionStyle" /><FieldRef Name="nCcSliderBodyClass" /><FieldRef Name="nCcSliderBodyStyle" /><FieldRef Name="nTileCustomID" /><FieldRef Name="nTileCustomClassEs" /></ViewFields></viewFields>';bS+='<rowLimit>0</rowLimit>';bS+='</GetListItems>';bl("Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",bS,function(a,b){var c=b.responseXML;if(!a){if(bs){bs(bm(c,"errorcode")[0].childNodes[0].nodeValue=="0x82000006"?2:3);return}}var d=bm(c,"row","z");var e="";var f=100;var g=100;if(d.length){var h=-1;var j=-1;for(var i=0,num=d.length;i<num;++i){var k="";var l=d[i];var m=l.getAttribute("ows_ID");var n=parseFloat(l.getAttribute("ows_nTileWidthOnGrid"));var o=parseFloat(l.getAttribute("ows_nTileHeightOnGrid"));var p=parseFloat(l.getAttribute("ows_nTileLeftOffset"));var q=parseFloat(l.getAttribute("ows_nTileTopOffset"));var r=parseFloat(l.getAttribute("ows_nCcTileBottomEdge").replace(/^[a-z]*?;#/i,""));var s=parseFloat(l.getAttribute("ows_nCcTileRightEdge").replace(/^[a-z]*?;#/i,""));var t=parseInt(l.getAttribute("ows_nTileBorderWidth"));var u=l.getAttribute("ows_nTileZoomOnHover");var v=l.getAttribute("ows_nTileLinkType");var w=l.getAttribute("ows_nTileLinkURL")?l.getAttribute("ows_nTileLinkURL").replace(/\s|\r|\n/g,""):l.getAttribute("ows_nTileLinkURL");var x=l.getAttribute("ows_nTileImageURL");var y=l.getAttribute("ows_nTileImageURLOnHover")?l.getAttribute("ows_nTileImageURLOnHover"):l.getAttribute("ows_nTileImageURLOnHover");var z=l.getAttribute("ows_nIsHeading");var A=l.getAttribute("ows_nHeadingContent");var B=l.getAttribute("ows_nHeadingContentOnHover");var C=parseInt(l.getAttribute("ows_nSliderHeadingHeight"));var D=l.getAttribute("ows_nSliderBodyContent");var E=l.getAttribute("ows_nCcTileBackgroundClass").replace(/^[a-z]*?;#/i,"");var F=l.getAttribute("ows_nCcTileBackgroundStyle").replace(/^[a-z]*?;#/i,"");var G=l.getAttribute("ows_nCcTileBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var H=l.getAttribute("ows_nCcTileBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,"");var I=l.getAttribute("ows_nCcTileImagePositionStyle").replace(/^[a-z]*?;#/i,"");var J=l.getAttribute("ows_nCcTileImageClass").replace(/^[a-z]*?;#/i,"");var K=l.getAttribute("ows_nCcTileImageStyle").replace(/^[a-z]*?;#/i,"");var L=l.getAttribute("ows_nCcTileImageClassOnHover").replace(/^[a-z]*?;#/i,"");var M=l.getAttribute("ows_nCcTileImageStyleOnHover").replace(/^[a-z]*?;#/i,"");var N=l.getAttribute("ows_nCcTileFAPositionStyle").replace(/^[a-z]*?;#/i,"");var O=l.getAttribute("ows_nCcTileFAClass").replace(/^[a-z]*?;#/i,"");var P=l.getAttribute("ows_nCcTileFAStyle").replace(/^[a-z]*?;#/i,"");var Q=l.getAttribute("ows_nCcTileFAClassOnHover").replace(/^[a-z]*?;#/i,"");var R=l.getAttribute("ows_nCcTileFAStyleOnHover").replace(/^[a-z]*?;#/i,"");var S=l.getAttribute("ows_nCcHeadingPositionStyle").replace(/^[a-z]*?;#/i,"");var T=l.getAttribute("ows_nCcHeadingClass").replace(/^[a-z]*?;#/i,"");var U=l.getAttribute("ows_nCcHeadingStyle").replace(/^[a-z]*?;#/i,"");var V=l.getAttribute("ows_nCcHeadingClassOnHover").replace(/^[a-z]*?;#/i,"");var W=l.getAttribute("ows_nCcHeadingStyleOnHover").replace(/^[a-z]*?;#/i,"");var X=l.getAttribute("ows_nCcSliderBackgroundClass").replace(/^[a-z]*?;#/i,"");var Y=l.getAttribute("ows_nCcSliderBackgroundStyle").replace(/^[a-z]*?;#/i,"");var Z=l.getAttribute("ows_nCcSliderBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var bT=l.getAttribute("ows_nCcSliderBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,"");var bU=l.getAttribute("ows_nCcSliderPositionStyle").replace(/^[a-z]*?;#/i,"");var bV=l.getAttribute("ows_nCcSliderBodyClass").replace(/^[a-z]*?;#/i,"");var bW=l.getAttribute("ows_nCcSliderBodyStyle").replace(/^[a-z]*?;#/i,"");var bX=o*bO.gridHeight;var bY=n*bO.gridWidth;var bZ=(bX-t-t)-C;var ca=l.getAttribute("ows_nTileCustomID")||"nTile_"+m;var cb=(l.getAttribute("ows_nTileCustomClassEs")||"")+" nTile nTile_"+m;var cc="width:"+bY+"px;height:"+bX+"px;top:"+(q*bO.gridHeight)+"px;left:"+(p*bO.gridWidth)+"px;";var cd="nSPTiles.hover(true, this, '"+bq+"', "+m+", '"+z+"', '"+u+"')";var ce="nSPTiles.hover(false, this, '"+bq+"', "+m+", '"+z+"', '"+u+"')";if(v!="none")cb+=" nTileLink";var cf="nSPTiles.openLink(this, '"+v+"', '"+w+"')";if(h<s)h=s;if(j<r)j=r;k+='<div class="nTileContentWrapper" style="margin:'+t+'px">';if(E){k+='<div class="'+E+'" style="'+F+'"></div>';if(G)k+='<div class="'+G+'" style="'+H+'"></div>'}if(x){var cg='<img class="'+J+'" style="'+K+'" src="'+x+'" />';if(y)cg+='<img class="'+L+'" style="'+M+'" src="'+y+'" />';k+=bo("nTileImagePositionWrapper",I,'<div>'+cg+'</div>')}if(O){var cg='<span class="'+O+'" style="'+P+'"></span>';if(Q)cg+='<span class="'+Q+'" style="'+R+'"></span>';k+=bo("nTileFAPositionWrapper",N,cg)}if(z=="1"){cb+=" nHeadingTile";var cg='<div class="'+T+'" style="'+U+'">'+(A||"")+'</div>';if(B)cg+='<div class="'+V+'" style="'+W+'">'+(B||"")+'</div>';k+=bo("nTileHeadingPositionWrapper",S,cg)}else{cb+=" nSliderTile";k+='<div class="nTileSliderContent" style="top:'+bZ+'px">';if(X){k+='<div class="'+X+'" style="'+Y+'"></div>';if(Z)k+='<div class="'+Z+'" style="'+bT+'"></div>'}var ch='<div class="'+T+'" style="'+U+'">'+(A||"")+'</div>';if(B)ch+='<div class="'+V+'" style="'+W+'">'+(B||"")+'</div>';var ci='<div class="'+bV+'" style="'+bW+'">'+D+'</div>';k+=bo("nTileSliderPositionWrapper",S,ch,bU,ci);k+='</div>'}k+='</div>';e+='<div id="'+ca+'" class="'+cb+'" style="'+cc+'" onmouseenter="'+cd+'" onmouseleave="'+ce+'" onclick="'+cf+'">'+k+'</div>'}f=h*bO.gridWidth;g=j*bO.gridHeight;bQ.innerHTML=e}else{bQ.innerHTML=""}bP.style.height=g+"px"nTilesContainer.style.height=g+"px";bQ.style.width=f+"px";if(bs)bs(0)},br)};var cj=function(a,b,c,d){if(b){var e=a.querySelectorAll(".nTile");var f=bk("div",null,"nTileHoverBox",{"style":"text-align: center;","innerText":"tile"});if(c)f.style.cursor=c;for(var i=0,num=e.length;i<num;++i){var g=e[i];var h=f.cloneNode(true);h.style.lineHeight=g.style.height;if(d)h.onmousemove=d;g.appendChild(h)}}else{var j=a.querySelectorAll(".nTileHoverBox");for(var i=0,num=j.length;i<num;++i){var f=j[i];f.onmousemove=null;bi(f)}}};var ck=function(a,b,c){var d='<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';d+='<listName>'+bc+'</listName>';d+='<updates>';d+='<Batch OnError="Continue">';d+='<Method ID="1" Cmd="'+a+'">';for(i in b){d+='<Field Name="'+i+'">'+b[i]+'</Field>'}d+='</Method>';d+='</Batch>';d+='</updates>';d+='</UpdateListItems>';bl("Lists.asmx?op=UpdateListItems","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",d,c,true)};var cl=bf.openLink=function(c,d,e){var f={"url":e};switch(d){case"none":break;case"current window":location.href=e;break;case"new window":window.open(e);break;case"dialog":SP.UI.ModalDialog.showModalDialog(f);break;case"dialog (refresh window after save)":f.dialogReturnValueCallback=function(a,b){if(a==SP.UI.DialogResult.OK){location.href=location.href}};SP.UI.ModalDialog.showModalDialog(f);break;case"dialog (refresh tiles after save)":f.dialogReturnValueCallback=function(a,b){if(a==SP.UI.DialogResult.OK){bp(c.parentNode.parentNode.id,true)}};SP.UI.ModalDialog.showModalDialog(f);break;default:alert("I don't know how to handle open a link of type '"+d+"'.");break}};var cm=bf.hover=function(b,c,d,e,f,g){var h=bg[d];var i=h.tiles[c.id]=h.tiles[c.id]||{};if(/ nTileHovering/.test(c.className))c.className=c.className.replace(/ nTileHovering/,"");else c.className+=" nTileHovering";if("animationID"in i){bj.stop(i.animationID)}if(g==="Yes"||g==="1"){var j=c.querySelector(".nTileContentWrapper");var k=i.margin=i.margin||parseInt(j.style.margin.replace("px",""));var l=parseInt(j.style.margin.replace("px",""));var m=b?0:k;var n=m-l}if(f!=="Yes"&&f!=="1"){var o=c.querySelector(".nTileSliderContent");var p=i.top=i.top||parseInt(o.style.top.replace("px",""));var q=parseInt(o.style.top.replace("px",""));var r=b?0:p;var s=r-q}if(g==="Yes"||g==="1"||f!=="Yes"&&f!=="1"){i.animationID=bj.start(b?h.animationTime:h.animationTime*.75,function(a){if(j)j.style.margin=l+(a*n)+"px";if(o)o.style.top=q+(a*s)+"px"},b)}};bf.setup=function(a,b,c,d,e){bg[a]={"holderID":a,"groupName":b,"gridHeight":d||50,"gridWidth":c||50,"animationTime":e||bb,"tilesWrapper":document.getElementById(a),"tiles":{}}};bf.init=function(h,k,l,n,o){var p=document.getElementById(h);if(p){bf.setup(h,k,l,n,o);p.className+=(p.className?" ":"")+"nTilesWrapper";p.innerHTML='<div class="nTilesContainer">Loading...</div>';bp(h,false,function(g){if(g==2){p.innerHTML="List '"+bc+"' does not exist. Click <a href='#'>here</a> to create it.";p.querySelector("a").onclick=function(){var f='';f+='<AddList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+bc+'</listName>';f+='<description>List used to house tile configuration for nTiles.</description>';f+='<templateID>100</templateID>';f+='</AddList>';bl("Lists.asmx?op=AddList","http://schemas.microsoft.com/sharepoint/soap/AddList",f,function(d,e){if(!d){p.innerHTML="Unable to create the list."}else{p.innerHTML="List '"+bc+"' created. Updating list...";setTimeout(function(){f='';f+='<UpdateList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+bc+'</listName>';f+='<listProperties>';f+='<List EnableAttachments="FALSE" OnQuickLaunch="TRUE" Description="List used to house tile configuration for nTiles. (v1.0)" />';f+='</listProperties>';f+='<newFields>';f+='<Fields>'for(var i=0,num=be.length;i<num;++i){var c=be[i];c.Name="n"+c.DisplayName.replace(/\b\w/g,function(m){return m.toUpperCase()}).replace(/[^a-zA-Z]/g,"");f+='<Method ID="'+(i+2)+'"'+(c.Type!="Calculated"?' AddToView=""':'')+'><Field Type="'+c.Type+'" DisplayName="'+c.Name+'" '+(c.Type=="Calculated"?'ResultType="'+c.ReturnType+'"><Formula>=1</Formula></Field>':'/>')+'</Method>'}f+='</Fields>';f+='</newFields>';f+='<updateFields>';f+='<Fields>';f+='<Method ID="1">';f+='<Field Type="Text" Name="Title" DisplayName="group name" Required="TRUE" Description="the name of the group this tile belongs to"/>';f+='</Method>';for(var i=0,num=be.length;i<num;++i){var c=be[i];f+='<Method ID="'+(be.length+i+2)+'"><Field Type="'+c.Type+'" Name="'+c.Name+'"';for(attribute in c){if(attribute=="Type"||attribute=="Name"||attribute=="Default"||attribute=="Validation"||attribute=="Choices"||attribute=="Formula")continue;f+=' '+attribute+'="'+c[attribute]+'"'}f+='>';if(c.hasOwnProperty("Formula")){f+='<Formula>'+c.Formula+'</Formula>'}if(c.hasOwnProperty("Default")){f+='<Default>'+c.Default+'</Default>'}if(c.hasOwnProperty("Validation")){f+='<Validation Message="'+c.Validation.Message+'">'+c.Validation.Function+'</Validation>'}if(c.hasOwnProperty("Choices")){f+='<CHOICES>';if(typeof(c.Choices)==="number"){f+='<CHOICE>none</CHOICE>';for(var j=0;j<=c.Choices;++j){f+='<CHOICE>'+j+'</CHOICE>'}}else{f+='<CHOICE>'+c.Choices.split(",").join('</CHOICE><CHOICE>')+'</CHOICE>'}f+='</CHOICES>'}f+='</Field></Method>'}f+='</Fields>';f+='</updateFields>';f+='</UpdateList>';window["soap"]=f;bl("Lists.asmx?op=UpdateList","http://schemas.microsoft.com/sharepoint/soap/UpdateList",f,function(a,b){if(a){p.innerHTML="";alert("Finished creating and updating the list.\nReloading the page.\nHappy tiling!");location.reload()}else{p.innerHTML="Unable to add fields to the list."}})},1)}});return false}}else if(g==3){alert("unknown error")}else if(g==0){ExecuteOrDelayUntilScriptLoaded(function(){var a=new SP.ClientContext.get_current();this.list=a.get_web().get_lists().getByTitle(bc);a.load(list);a.load(list,'EffectiveBasePermissions');a.executeQueryAsync(Function.createDelegate(this,function(){if(this.list.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)){bk("span",p,"nTileAdminLinks",{"innerHTML":'<b>actions</b>:&nbsp;<a href="#" title="add a tile" onclick="nSPTiles.startAddOrMoveTile(this, \'New\', \''+h+'\'); return false;">add</a>&nbsp;|&nbsp;<a href="#" title="move a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Update\', \''+h+'\'); return false;">move</a>&nbsp;|&nbsp;<a href="#" title="edit a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Edit\', \''+h+'\'); return false;">edit</a>&nbsp;|&nbsp;<a href="#" title="delete a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Delete\', \''+h+'\'); return false;">delete</a>&nbsp;|&nbsp;<a target="_blank" href="'+ba+'Lists/'+bc+'">list</a>'})}}),Function.createDelegate(this,function(){}))},"sp.js")}})}else if(document.readyState=="complete"){alert("An element with the ID '"+h+"' was not found.")}else{if(document.addEventListener){document.addEventListener('DOMContentLoaded',function(){bf.init(h,k,l,n,o)})}else{document.attachEvent('onreadystatechange',function(){if(document.readyState!='loading')bf.init(h,k,l,n,o)})}}};bf.startAddOrMoveTile=function(a,h,i,j,k){a.parentNode.style.display="none";var l=bg[i];var m=l.tilesWrapper;var n=bk("div",m,"nTileOverlay");var o=bk("div",m,"nTileGridBox",{"style":"width: "+l.gridWidth+"px; height: "+l.gridHeight+"px;"});var p=bk("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> where you want the <u>top left</u> of the tile to be.<br /><br />Press <u>escape</u> to cancel."});var q=bk("div",document.body,null,{"id":"nTilesToolTip","innerHTML":'left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var r=document.getElementById("nTilesToolTipLeft");var s=document.getElementById("nTilesToolTipTop");var t=document.getElementById("nTilesToolTipWidth");var u=document.getElementById("nTilesToolTipHeight");var v=m.offsetHeight;var w=function(){document.onkeyup=null;o.onclick=null;m.onmousemove=null;bi(n);bi(o);bi(p);bi(r);bi(s);bi(t);bi(u);bi(q);cj(m,false);if(j)j.className=j.className.replace(/ nTileFocus/,"");m.style.height=v;a.parentNode.style.display=""};o.onclick=function(){o.className+=" clicked";var f=r.innerText;var g=s.innerText;o.onclick=function(){var d=t.innerText;var e=u.innerText;ck(h,{"ID":h=="New"?"New":k,"Title":l.groupName,"nTileWidthOnGrid":d,"nTileHeightOnGrid":e,"nTileLeftOffset":f,"nTileTopOffset":g},function(b,c){w();if(b){bp(i,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to "+(h=="New"?"add a new":"update existing")+" tile.")}})};m.onmousemove=function(e){var c=bn(e,m);var a=Math.floor(c.elementX/l.gridWidth)-f+1;var b=Math.floor(c.elementY/l.gridHeight)-g+1;q.style.top=c.pageY+25+"px";q.style.left=c.pageX+25+"px";t.innerText=a;u.innerText=b;if(a>0&&b>0){o.style.width=a*l.gridWidth+"px";o.style.height=b*l.gridHeight+"px"}};p.innerHTML="<b>Click</b> where you want the <u>bottom right</u> of the tile to be.<br /><br />Press <u>escape</u> to cancel."};m.onmousemove=function(e){var c=bn(e,m);var a=Math.floor(c.elementY/l.gridHeight);var b=Math.floor(c.elementX/l.gridWidth);o.style.top=a*l.gridHeight+"px";o.style.left=b*l.gridWidth+"px";q.style.top=c.pageY+25+"px";q.style.left=c.pageX+25+"px";r.innerText=b;s.innerText=a};cj(m,true);if(h=="Update"){j.className+=" nTileFocus";j.querySelector(".nTileHoverBox").innerText="moving"}document.onkeyup=function(e){if((e||window.event).keyCode==27){w()}};m.style.height=v+500+"px"};bf.startTilesMoveEditDelete=function(a,f,g){a.parentNode.style.display="none";bf.hover=bf.openLink=bh;var h=bg[g];var i=h.tilesWrapper;var j=bk("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> on the tile you want to <u>"+f+"</u>.<br /><br />Press <u>escape</u> to cancel."});var k=bk("div",document.body,null,{"id":"nTilesToolTip","style":"display: none;","innerHTML":'<b>action&nbsp;: <span>'+f+'</span><br />ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipID"></span></b><br /><br /><br />left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var l=document.getElementById("nTilesToolTipID");var m=document.getElementById("nTilesToolTipLeft");var n=document.getElementById("nTilesToolTipTop");var o=document.getElementById("nTilesToolTipWidth");var p=document.getElementById("nTilesToolTipHeight");bf.hover=function(a,b,c,d){if(a){b.className+=" nTileFocus";k.style.display="block";l.innerText=d;m.innerText=b.style.left.replace("px","")/h.gridWidth;n.innerText=b.style.top.replace("px","")/h.gridHeight;o.innerText=b.style.width.replace("px","")/h.gridWidth;p.innerText=b.style.height.replace("px","")/h.gridHeight}else{k.style.display="none";b.className=b.className.replace(/ nTileFocus/,"")}};bf.openLink=function(d){var e=l.innerText;d.className=d.className.replace(/ nTileFocus/,"");q();if(f=="Edit"){bf.openLink(d,"dialog (refresh tiles after save)",ba+"Lists/"+bc+"/EditForm.aspx?ID="+e)}else if(f=="Delete"){if(confirm("Are you sure you want to delete the tile?")){ck(f,{"ID":e},function(b,c){if(b){bp(g,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to delete the tile.")}})}}else{bf.startAddOrMoveTile(a,f,g,d,e)}};var q=function(){document.onkeyup=null;bi(j);bi(l);bi(m);bi(n);bi(o);bi(p);bi(k);cj(i,false);bf.openLink=cl;bf.hover=cm;a.parentNode.style.display=""};cj(i,true,f=="Update"?"move":"context-menu",function(e){var c=bn(e,i);k.style.top=c.pageY+25+"px";k.style.left=c.pageX+25+"px"});document.onkeyup=function(e){if((e||window.event).keyCode==27){q()}}};var cn=bk("style",document.head||document.getElementsByTagName('head')[0],{"type":"text/css"});if(cn.styleSheet){cn.styleSheet.cssText=bd}else{cn.appendChild(document.createTextNode(bd))}return bf})();
