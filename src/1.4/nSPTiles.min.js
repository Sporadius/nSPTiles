/* nSPTiles 1.4 | https://github.com/imthenachoman/nSPTiles | Copyright (c) 2015 Anchal Nigam (imthenachoman@gmail.com) | MIT license (http://opensource.org/licenses/mit) */
var nSPTiles=nSPTiles||function(){"use strict";var a=150,b="nSPTiles1_4",c=".nTilesWrapper,.nTilesContainer,.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{margin:0;padding:0;overflow:hidden}.nTilesWrapper{position:relative}.nTilesContainer{position:relative;display:inline-block}.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{position:absolute;top:0;left:0;bottom:0;right:0}.nTilePositionTable{position:absolute;display:table;width:100%;height:100%}.nTilePositionRow{display:table-row}.nTilePositionCell{display:table-cell;width:100%;height:100%}.nHoverOption1,.nTileHovering .nHoverOption2{display:inline-block!important}.nHoverOption2,.nTileHovering .nHoverOption1{display:none!important}.nTileSliderContent{position:absolute;height:100%;width:100%}.nTileLink{cursor:pointer}.nTileAdminLinks{position:absolute;top:0;right:0;padding:5px;display:none;z-index:50;background-color:#ff9;border:1px solid #000;filter:alpha(opacity=30);opacity:.3}.nTilesWrapper:hover .nTileAdminLinks{display:inline-block}.nTileAdminLinks:hover{filter:(alpha=100);opacity:1}.nTileAdminLinks:hover .nTileAdminLinksOff{display:none}.nTileAdminLinks:hover .nTileAdminLinksOn{display:inline-block}.nTileAdminLinks .nTileAdminLinksOn{display:none}.nTileGridBox{position:absolute;filter:alpha(opacity=30);opacity:.3;background-color:#f00;z-index:100;top:0;left:0}.nTileGridBox.nTileGridBoxClicked{background-color:blue}.nTileOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0f0;filter:alpha(opacity=10);opacity:.1;z-index:95}#nTilesHelp{position:fixed;top:10px;left:10px;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}#nTilesToolTip{font-family:'Lucida Console';position:fixed;top:0;left:0;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}.nTileHoverBox{position:absolute;top:0;left:0;width:100%;height:100%;z-index:50;background-color:#ff0;filter:alpha(opacity=50);opacity:.5}.nTileFocus .nTileHoverBox{background-color:#0ff;font-weight:700;text-decoration:underline}#nTilesHelp table{border-collapse:collapse}#nTilesHelp th, #nTilesHelp td{padding:5px}#nTilesHelp th{text-align:right}",d=[{DisplayName:"active",Type:"Boolean",Description:"can be used hide a tile without having to remove this entry",Default:"1"},{DisplayName:"tile width",Type:"Number",Description:"the width of the tile in px",Default:"100",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile height",Type:"Number",Description:"the height of the tile in px",Default:"100",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile left offset",Type:"Number",Description:"the left offset of the tile in px",Default:"0",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile top offset",Type:"Number",Description:"the top offset of the tile in px",Default:"0",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile border width",Type:"Number",Description:"the empty space around the tile in px",Default:"2",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile zoom on hover",Type:"Boolean",Description:"zoom effect for the tile by making the tile border width 0 when the mouse is over the tile",Default:"1",Required:"FALSE"},{DisplayName:"tile link type",Type:"Choice",Description:"the type of link to make",Default:"none",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"none,current window,new window,mailto,dialog,dialog (refresh window after save),dialog (refresh tiles after save),group, javascript function"},{DisplayName:"tile link URL",Type:"Note",Description:"the URL for the link",Required:"FALSE",NumLines:"3",RichText:"FALSE"},{DisplayName:"is heading",Type:"Boolean",Description:"heading tiles have no slider",Default:"0"},{DisplayName:"tile background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"rgb(0,114,198)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Default:"none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile background color on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile background opacity on hover",Type:"Choice",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image URL",Type:"Text",Description:"URL of image to use in tile (must be less then 255 characters)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image width",Type:"Text",Description:"width of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image width]="",AND(ISNUMBER([tile image width]+0),ROUND([tile image width]+0,0)=([tile image width]+0)),AND(RIGHT([tile image width],1)="%",ISNUMBER(LEFT([tile image width],LEN([tile image width])-1)+0)))'}},{DisplayName:"tile image height",Type:"Text",Description:"height of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image height]="",AND(ISNUMBER([tile image height]+0),ROUND([tile image height]+0,0)=([tile image height]+0)),AND(RIGHT([tile image height],1)="%",ISNUMBER(LEFT([tile image height],LEN([tile image height])-1)+0)))'}},{DisplayName:"tile image opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image padding",Type:"Number",Description:"how far from the edge of the tile should the image be in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"tile image style",Type:"Text",Description:"css style to apply to the tile image (overrides above tile image options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image position",Type:"Choice",Description:"position of the image in the tile",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile image URL on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA class",Type:"Text",Description:"Font Awesome icon class name",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile FA padding",Type:"Number",Description:"how far from the edge of the tile should the icon be in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"tile FA style",Type:"Text",Description:"css style to apply to the FA icon (overrides above tile FA options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA position",Type:"Choice",Description:"position of the icon in the tile",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile FA class on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading content",Type:"Text",Description:"can use HTML",Default:"heading",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading bolded",Type:"Boolean",Description:"should the heading text be bold",Default:"1"},{DisplayName:"heading font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"white",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading font size",Type:"Number",Description:"font size for the heading in px",Default:"10",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"heading padding",Type:"Number",Description:"padding for the heading in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"heading style",Type:"Text",Description:"css style to apply to heading (overrides above heading options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading position",Type:"Choice",Description:"position of the heading in the tile or slider heading",Default:"bottom left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"heading content on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider heading height",Type:"Number",Description:"height of the header for the slider in px",Default:"25",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body content",Type:"Note",Description:"can use HTML",Default:"body",Required:"FALSE",NumLines:"5",RichText:"FALSE"},{DisplayName:"slider body font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"white",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider body font size",Type:"Number",Description:"font size for the slider body in px",Default:"10",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body padding",Type:"Number",Description:"padding of the slider body in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body style",Type:"Text",Description:"css style to apply to slider body (overrides above slider body options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider body position",Type:"Choice",Description:"position of the slider body in the slider",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"slider background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"black",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Default:"50",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"slider background color on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background opacity on hover",Type:"Choice",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image and FA slider heading push",Type:"Boolean",Description:"if the tile image and/or FA are positioned on the bottom then push them on top of the slider heading",Default:"1"},{DisplayName:"tile custom ID",Type:"Text",Description:"custom ID to use for the tile &#xD;&#xA;&#xD;&#xA;default is nTile_[ID] where ID is the ID of the entry in the list",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile custom class(es)",Type:"Text",Description:"custom class(s) to add to the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"cc tile style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("width: ",[tile width],"px; height: ",[tile height],"px; top: ",[tile top offset],"px; left: ",[tile left offset],"px;")'},{DisplayName:"cc tile content wrapper style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("margin: ",[tile border width],"px;")'},{DisplayName:"cc tile right edge",Type:"Calculated",Decimals:"0",ResultType:"Number",Formula:"=[tile left offset]+[tile width]"},{DisplayName:"cc tile bottom edge",Type:"Calculated",Decimals:"0",ResultType:"Number",Formula:"=[tile top offset]+[tile height]"},{DisplayName:"cc tile background class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]<>"","nTileBackground"&IF([tile background color on hover]<>""," nHoverOption1","")&IF(LEFT([tile background color],1)="."," "&REPLACE([tile background color],1,1,""),""),"")'},{DisplayName:"cc tile background style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]<>"",IF(AND([tile background opacity]<>"",[tile background opacity]<>"none"),"filter: alpha(opacity="&[tile background opacity]&"); opacity: "&"0."&right("0"&[tile background opacity],2)&"; ","")&IF(AND([tile background color]<>"",LEFT([tile background color],1)<>"."),"background-color: "&[tile background color]&"; ",""),"")'},{DisplayName:"cc tile background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]<>"",[tile background color on hover]<>""),"nTileBackground nHoverOption2"&IF(LEFT([tile background color on hover],1)="."," "&REPLACE([tile background color on hover],1,1,""),""),"")'},{DisplayName:"cc tile background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]<>"",[tile background color on hover]<>""),IF(AND([tile background opacity on hover]<>"",[tile background opacity on hover]<>"none"),"filter: alpha(opacity="&[tile background opacity on hover]&"); opacity: "&"0."&right("0"&[tile background opacity on hover],2)&"; ","")&IF(AND([tile background color on hover]<>"",LEFT([tile background color on hover],1)<>"."),"background-color: "&[tile background color on hover]&"; ",""),"")'},{DisplayName:"cc tile image and fa table style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image and FA slider heading push],NOT([is heading]),OR([tile image URL]<>"",[tile FA class]<>"")),"height: 0;","")'},{DisplayName:"cc tile image position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]<>"","vertical-align: "&LEFT([tile image position],SEARCH(" ",[tile image position])-1)&"; text-align: "&RIGHT([tile image position],LEN([tile image position])-SEARCH(" ",[tile image position]))&"; "&IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&[tile height]-[tile border width]-[tile border width]-[slider heading height]&"px",""),"")'},{DisplayName:"cc tile image class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]<>"","nTileImage"&IF([tile image URL on hover]<>""," nHoverOption1",""),"")'},{DisplayName:"cc tile image style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]<>"",IF([tile image width]<>"","width: "&IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&"px")&"; ","")&IF([tile image height]<>"","height: "&IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&"px")&"; ","")&IF([tile image padding]<>"","padding: "&[tile image padding]&"px; ","")&IF(AND([tile image opacity]<>"",[tile image opacity]<>"none"),"filter: alpha(opacity="&[tile image opacity]&"); opacity: "&"0."&right("0"&[tile image opacity],2)&"; ","")&[tile image style],"")'},{DisplayName:"cc tile image class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]<>"",[tile image URL on hover]<>""),"nTileImage nHoverOption2","")'},{DisplayName:"cc tile image style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]<>"",[tile image URL on hover]<>""),IF([tile image width]<>"","width: "&IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&"px")&"; ","")&IF([tile image height]<>"","height: "&IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&"px")&"; ","")&IF([tile image padding]<>"","padding: "&[tile image padding]&"px; ","")&IF(AND([tile image opacity]<>"",[tile image opacity]<>"none"),"filter: alpha(opacity="&[tile image opacity]&"); opacity: "&"0."&right("0"&[tile image opacity],2)&"; ","")&[tile image style on hover],"")'},{DisplayName:"cc tile FA position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]<>"","vertical-align: "&LEFT([tile FA position],SEARCH(" ",[tile FA position])-1)&"; text-align: "&RIGHT([tile FA position],LEN([tile FA position])-SEARCH(" ",[tile FA position]))&"; "&IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&[tile height]-[tile border width]-[tile border width]-[slider heading height]&"px",""),"")'},{DisplayName:"cc tile FA class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]<>"","nTileFA fa "&[tile FA class]&IF([tile FA class on hover]<>""," nHoverOption1","")&IF(AND([tile FA color]<>"",LEFT([tile FA color],1)=".")," "&REPLACE([tile FA color],1,1,""),""),"")'},{DisplayName:"cc tile FA style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]<>"",IF(AND([tile FA opacity]<>"",[tile FA opacity]<>"none"),"filter: alpha(opacity="&[tile FA opacity]&"); opacity: "&"0."&right("0"&[tile FA opacity],2)&"; ","")&IF([tile FA padding]<>"","padding: "&[tile FA padding]&"px; ","")&IF(AND([tile FA color]<>"",LEFT([tile FA color],1)<>"."),"color: "&[tile FA color]&";","")&[tile FA style],"")'},{DisplayName:"cc tile FA class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]<>"",[tile FA class on hover]<>""),"nTileFA fa "&[tile FA class on hover]&" nHoverOption2"&IF(AND([tile FA color]<>"",LEFT([tile FA color],1)=".")," "&REPLACE([tile FA color],1,1,""),""),"")'},{DisplayName:"cc tile FA style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]<>"",[tile FA class on hover]<>""),IF(AND([tile FA opacity]<>"",[tile FA opacity]<>"none"),"filter: alpha(opacity="&[tile FA opacity]&"); opacity: "&"0."&right("0"&[tile FA opacity],2)&"; ","")&IF([tile FA padding]<>"","padding: "&[tile FA padding]&"px; ","")&IF(AND([tile FA color]<>"",LEFT([tile FA color],1)<>"."),"color: "&[tile FA color]&"; ","")&[tile FA style on hover],"")'},{DisplayName:"cc heading position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]<>"","vertical-align: "&LEFT([heading position],SEARCH(" ",[heading position])-1)&"; text-align: "&RIGHT([heading position],LEN([heading position])-SEARCH(" ",[heading position]))&"; "&IF(NOT([is heading]),"height: "&[slider heading height]&"px; ",""),"")'},{DisplayName:"cc heading class",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]<>"","nTileHeading"&IF([heading content on hover]<>""," nHoverOption1","")&IF(LEFT([heading font color])="."," "&REPLACE([heading font color],1,1,""),""),"")'},{DisplayName:"cc heading style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]<>"",IF([heading bolded],"font-weight: bold; ","")&IF([heading padding]<>"","padding: "&[heading padding]&"px; ","")&IF([heading font size]<>"","font-size: "&[heading font size]&"px; ","")&IF(AND([heading font color]<>"",LEFT([heading font color],1)<>"."),"color: "&[heading font color]&"; ","")&[heading style],"")'},{DisplayName:"cc heading class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]<>"",[heading content on hover]<>""),"nTileHeading nHoverOption2"&IF(LEFT([heading font color])="."," "&REPLACE([heading font color],1,1,""),""),"")'},{DisplayName:"cc heading style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]<>"",[heading content on hover]<>""),IF([heading bolded],"font-weight: bold; ","")&IF([heading padding]<>"","padding: "&[heading padding]&"px; ","")&IF([heading font size]<>"","font-size: "&[heading font size]&"px; ","")&IF(AND([heading font color]<>"",LEFT([heading font color],1)<>"."),"color: "&[heading font color]&"; ","")&[heading style on hover],"")'},{DisplayName:"cc slider content style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),CONCATENATE("top: ",[tile height]-[tile border width]-[tile border width]-[slider heading height],"px;"),"")'},{DisplayName:"cc slider position style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"vertical-align: "&LEFT([slider body position],SEARCH(" ",[slider body position])-1)&"; text-align: "&RIGHT([slider body position],LEN([slider body position])-SEARCH(" ",[slider body position]))&"; ","")'},{DisplayName:"cc slider body class",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"nTileSlider"&IF(LEFT([slider body font color],1)="."," "&REPLACE([slider body font color],1,1,""),""),"")'},{DisplayName:"cc slider body style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),[slider body style]&"; "&IF([slider body padding]<>"","padding: "&[slider body padding]&"px; ","")&IF([slider body font size]<>"","font-size: "&[slider body font size]&"px; ","")&IF(AND([slider body font color]<>"",LEFT([slider body font color],1)<>"."),"color: "&[slider body font color]&"; ",""),"")'},{DisplayName:"cc slider background class",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]<>""),"nTileBackground"&IF([slider background color on hover]<>""," nHoverOption1","")&IF(LEFT([slider background color],1)="."," "&REPLACE([slider background color],1,1,""),""),"")'},{DisplayName:"cc slider background style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]<>""),IF(AND([slider background opacity]<>"",[slider background opacity]<>"none"),"filter: alpha(opacity="&[slider background opacity]&"); opacity: "&"0."&right("0"&[slider background opacity],2)&"; ","")&IF(AND([slider background color]<>"",LEFT([slider background color],1)<>"."),"background-color: "&[slider background color]&"; ",""),"")'},{DisplayName:"cc slider background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]<>"",[slider background color on hover]<>""),"nTileBackground nHoverOption2"&IF(LEFT([slider background color on hover],1)="."," "&REPLACE([slider background color on hover],1,1,""),""),"")'},{DisplayName:"cc slider background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]<>"",[slider background color on hover]<>""),IF(AND([slider background opacity on hover]<>"",[slider background opacity on hover]<>"none"),"filter: alpha(opacity="&[slider background opacity on hover]&"); opacity: "&"0."&right("0"&[slider background opacity on hover],2)&"; ","")&IF(AND([slider background color on hover]<>"",LEFT([slider background color on hover],1)<>"."),"background-color: "&[slider background color on hover]&"; ",""),"")'}],e={},f={},g=function(a){a.parentNode.removeChild(a)},h=function(){for(var a=0,b={},c=0,d=["ms","moz","webkit","o"],e=0;e<d.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[d[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[e]+"CancelAnimationFrame"]||window[d[e]+"CancelRequestAnimationFrame"];return window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-c)),e=window.setTimeout(function(){a(b+d)},d);return c=b+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),{stop:function(a){cancelAnimationFrame(b[a]),delete b[a]},start:function(c,d,e){var f=a++,g=+new Date,j=function(){var a=+new Date-g;a>=c?(d(1),h.stop(f)):(d(i[e](a,0,1,c)),b[f]=requestAnimationFrame(j))};return j(),f}}}(),i={slide:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},bounce:function(a,b,c,d){return(a/=d)<1/2.75?c*(7.5625*a*a)+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},elastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(0===a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin((a*d-e)*(2*Math.PI)/f)+c+b}},j=function(a,b,c,d){var e=document.createElement(a);if(c&&(e.className=c),d)for(var f in d)/^(inner|on)\w+$/i.test(f)?e[f]=d[f]:e.setAttribute(f,d[f]);return b&&b.appendChild(e),e},k=function(a,b,c,d,e,f){var g="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");g.open("post",a+"/_vti_bin/"+b,"undefined"!=typeof f&&null!==f&&f),g.setRequestHeader("SOAPAction",c),g.setRequestHeader("Content-Type",'text/xml; charset="utf-8"'),g.onreadystatechange=function(){4==g.readyState&&e(200==g.status,g)},g.send('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>'+d+"</soap:Body></soap:Envelope>")},l=function(a,b,c){return a.getElementsByTagNameNS?a.getElementsByTagNameNS("*",b):a.getElementsByTagName(c+":"+b)},m=function(a,b){var a=a||window.event,c={pageX:0,pageY:0,elementX:0,elementY:0};if(a.pageX||a.pageY?(c.pageX=a.pageX,c.pageY=a.pageY):(a.clientX||a.clientY)&&(c.pageX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c.pageY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),b){var d=b.getBoundingClientRect();c.elementX=c.pageX-d.left,c.elementY=c.pageY-d.top}return c},n=function(a,b,c,d,e,f){var g='<div class="nTilePositionTable '+a+'" style="'+b+'">';return g+='<div class="nTilePositionRow nTilePositionRow1"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+c+';">'+d+"</div></div>",e&&(g+='<div class="nTilePositionRow nTilePositionRow2"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+e+'">'+f+"</div></div>"),g+"</div>"},o=function(){var a="";a='<FieldRef Name="ID" />';for(var b=0,c=d.length;b<c;++b)a+='<FieldRef Name="n'+d[b].DisplayName.replace(/\b\w/g,function(a){return a.toUpperCase()}).replace(/[^a-zA-Z]/g,"")+'" />';return a},p=function(a,c,d){var e=f[a],g=e.tilesWrapper,h=g.querySelector(".nTilesContainer");e.tiles={};for(var i=h.querySelectorAll(".nTile"),j=0,m=i.length;j<m;++j)i[j].onclick=i[j].onmouseenter=i[j].onmouseleave=null;h.innerText="Please wait while I reload the data...";var p="";p+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">',p+="<listName>"+b+"</listName>",p+='<query><Query><Where><And><Eq><FieldRef Name="Title"/><Value Type="Text">'+e.groupName+'</Value></Eq><Eq><FieldRef Name="nActive"/><Value Type="Boolean">1</Value></Eq></And></Where></Query></query>',p+="<viewFields><ViewFields>"+o()+"</ViewFields></viewFields>",p+="<rowLimit>0</rowLimit>",p+="</GetListItems>",k(e.siteURL,"Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",p,function(a,b){if(!a)return void(d&&d(/<errorcode.*?>0x82000006<\/errorcode>/i.test(b.responseText)?2:/there is no web named/i.test(b.responseText)?3:4));var c=l(b.responseXML,"row","z"),e="",f=100,i=100;if(c.length){for(var j=-1,k=-1,m=0,o=c.length;m<o;++m){var p=c[m],q="",r=parseInt(p.getAttribute("ows_nCcTileRightEdge").replace(/^[a-z]*?;#/i,""),10),s=parseInt(p.getAttribute("ows_nCcTileBottomEdge").replace(/^[a-z]*?;#/i,""),10),t=p.getAttribute("ows_nCcTileBackgroundClass").replace(/^[a-z]*?;#/i,""),u=p.getAttribute("ows_nCcTileBackgroundClassOnHover").replace(/^[a-z]*?;#/i,""),v=p.getAttribute("ows_nCcTileFAClass").replace(/^[a-z]*?;#/i,""),w=p.getAttribute("ows_nCcTileFAClassOnHover").replace(/^[a-z]*?;#/i,""),x=p.getAttribute("ows_nCcHeadingPositionStyle").replace(/^[a-z]*?;#/i,""),y=p.getAttribute("ows_nCcHeadingClass").replace(/^[a-z]*?;#/i,""),z=p.getAttribute("ows_nCcHeadingStyle").replace(/^[a-z]*?;#/i,""),A=p.getAttribute("ows_nCcHeadingClassOnHover").replace(/^[a-z]*?;#/i,""),B=p.getAttribute("ows_nCcHeadingStyleOnHover").replace(/^[a-z]*?;#/i,""),C=p.getAttribute("ows_nCcSliderBackgroundClass").replace(/^[a-z]*?;#/i,""),D=p.getAttribute("ows_nCcSliderBackgroundClassOnHover").replace(/^[a-z]*?;#/i,""),E=(p.getAttribute("ows_nTileCustomClassEs")||"")+" nTile nTile_"+p.getAttribute("ows_ID"),F="nSPTiles.hover(true, this, '"+p.getAttribute("ows_nIsHeading")+"', '"+p.getAttribute("ows_nTileZoomOnHover")+"')",G="nSPTiles.hover(false, this, '"+p.getAttribute("ows_nIsHeading")+"', '"+p.getAttribute("ows_nTileZoomOnHover")+"')";"none"!=p.getAttribute("ows_nTileLinkType")&&(E+=" nTileLink");var H="nSPTiles.openLink(this, '"+p.getAttribute("ows_nTileLinkType")+"', '"+(p.getAttribute("ows_nTileLinkURL")?p.getAttribute("ows_nTileLinkURL").replace(/\r|\n/g,""):p.getAttribute("ows_nTileLinkURL"))+"')";if(j<r&&(j=r),k<s&&(k=s),q+='<div class="nTileContentWrapper" style="'+p.getAttribute("ows_nCcTileContentWrapperStyle").replace(/^[a-z]*?;#/i,"")+'">',t&&(q+='<div class="'+t+'" style="'+p.getAttribute("ows_nCcTileBackgroundStyle").replace(/^[a-z]*?;#/i,"")+'"></div>',u&&(q+='<div class="'+u+'" style="'+p.getAttribute("ows_nCcTileBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,"")+'"></div>')),p.getAttribute("ows_nTileImageURL")){var I='<img class="'+p.getAttribute("ows_nCcTileImageClass").replace(/^[a-z]*?;#/i,"")+'" style="'+p.getAttribute("ows_nCcTileImageStyle").replace(/^[a-z]*?;#/i,"")+'" src="'+p.getAttribute("ows_nTileImageURL")+'" />';p.getAttribute("ows_nTileImageURLOnHover")&&(I+='<img class="'+p.getAttribute("ows_nCcTileImageClassOnHover").replace(/^[a-z]*?;#/i,"")+'" style="'+p.getAttribute("ows_nCcTileImageStyleOnHover").replace(/^[a-z]*?;#/i,"")+'" src="'+p.getAttribute("ows_nTileImageURLOnHover")+'" />'),q+=n("nTileImagePositionWrapper",p.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,""),p.getAttribute("ows_nCcTileImagePositionStyle").replace(/^[a-z]*?;#/i,""),'<div style="line-height: 0;">'+I+"</div>")}if(v){var I='<span class="'+v+'" style="'+p.getAttribute("ows_nCcTileFAStyle").replace(/^[a-z]*?;#/i,"")+'"></span>';w&&(I+='<span class="'+w+'" style="'+p.getAttribute("ows_nCcTileFAStyleOnHover").replace(/^[a-z]*?;#/i,"")+'"></span>'),q+=n("nTileFAPositionWrapper",p.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,""),p.getAttribute("ows_nCcTileFAPositionStyle").replace(/^[a-z]*?;#/i,""),I)}if("1"==p.getAttribute("ows_nIsHeading")){E+=" nHeadingTile";var I='<div class="'+y+'" style="'+z+'">'+(p.getAttribute("ows_nHeadingContent")||"")+"</div>";p.getAttribute("ows_nHeadingContentOnHover")&&(I+='<div class="'+A+'" style="'+B+'">'+(p.getAttribute("ows_nHeadingContentOnHover")||"")+"</div>"),q+=n("nTileHeadingPositionWrapper","",x,I)}else{E+=" nSliderTile",q+='<div class="nTileSliderContent" style="'+p.getAttribute("ows_nCcSliderContentStyle").replace(/^[a-z]*?;#/i,"")+'">',C&&(q+='<div class="'+C+'" style="'+p.getAttribute("ows_nCcSliderBackgroundStyle").replace(/^[a-z]*?;#/i,"")+'"></div>',D&&(q+='<div class="'+D+'" style="'+p.getAttribute("ows_nCcSliderBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,"")+'"></div>'));var J='<div class="'+y+'" style="'+z+'">'+(p.getAttribute("ows_nHeadingContent")||"")+"</div>";p.getAttribute("ows_nHeadingContentOnHover")&&(J+='<div class="'+A+'" style="'+B+'">'+(p.getAttribute("ows_nHeadingContentOnHover")||"")+"</div>");var K='<div class="'+p.getAttribute("ows_nCcSliderBodyClass").replace(/^[a-z]*?;#/i,"")+'" style="'+p.getAttribute("ows_nCcSliderBodyStyle").replace(/^[a-z]*?;#/i,"")+'">'+(p.getAttribute("ows_nSliderBodyContent")||"").replace(/\n/g,"<br />")+"</div>";q+=n("nTileSliderPositionWrapper","",x,J,p.getAttribute("ows_nCcSliderPositionStyle").replace(/^[a-z]*?;#/i,""),K),q+="</div>"}q+="</div>",e+='<div id="'+(p.getAttribute("ows_nTileCustomID")||"nTile_"+p.getAttribute("ows_ID"))+'" class="'+E+'" style="'+p.getAttribute("ows_nCcTileStyle").replace(/^[a-z]*?;#/i,"")+'" onmouseenter="'+F+'" onmouseleave="'+G+'" onclick="'+H+'">'+q+"</div>"}f=j,i=k,h.innerHTML=e}else h.innerHTML="";g.style.height=i+"px",
h.style.height=i+"px",h.style.width=f+"px",d&&d(0)},c)},q=function(a,b,c,d){if(b){var e=a.querySelectorAll(".nTile"),f=j("div",null,"nTileHoverBox",{style:"text-align: center;",innerText:"tile"});c&&(f.style.cursor=c);for(var h=0,i=e.length;h<i;++h){var k=e[h],l=f.cloneNode(!0);l.style.lineHeight=k.style.height,d&&(l.onmousemove=d),k.appendChild(l)}}else for(var m=a.querySelectorAll(".nTileHoverBox"),h=0,i=m.length;h<i;++h){var f=m[h];f.onmousemove=null,g(f)}},r=function(a,c,d,e){var f='<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+="<listName>"+b+"</listName>",f+="<updates>",f+='<Batch OnError="Continue">',f+='<Method ID="1" Cmd="'+c+'">';for(var g in d)d.hasOwnProperty(g)&&(f+='<Field Name="'+g+'">'+d[g]+"</Field>");f+="</Method>",f+="</Batch>",f+="</updates>",f+="</UpdateListItems>",k(a,"Lists.asmx?op=UpdateListItems","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",f,e,!0)},s=e.openLink=function(a,b,c){if("none"!==b){var d=a.parentNode.parentNode.id;if(/^mailto:.*?@.*$/.test(c))window.location=c;else{var e={url:c};switch(b){case"javascript function":window[c.split("[")[0]](c.split("[")[1].split("]")[0]);break;case"group":nSPTiles.init(d,c);break;case"mailto":location.href="mailto:"+c;break;case"current window":location.href=c;break;case"new window":window.open(c);break;case"dialog":SP.UI.ModalDialog.showModalDialog(e);break;case"dialog (refresh window after save)":e.dialogReturnValueCallback=function(a){a==SP.UI.DialogResult.OK&&(location.href=location.href)},SP.UI.ModalDialog.showModalDialog(e);break;case"dialog (refresh tiles after save)":e.dialogReturnValueCallback=function(b){b==SP.UI.DialogResult.OK&&p(a.parentNode.parentNode.id,!0)},SP.UI.ModalDialog.showModalDialog(e);break;default:alert("I don't know how to handle open a link of type '"+b+"'.")}}f[d].onclick&&f[d].onclick(c,b)}},t=e.hover=function(a,b,c,d){var e=b.parentNode.parentNode.id,g=f[e],i=g.tiles[b.id]=g.tiles[b.id]||{};if(a?b.className+=" nTileHovering":b.className=b.className.replace(/\ nTileHovering/,""),"animationID"in i&&h.stop(i.animationID),"Yes"===d||"1"===d)var j=b.querySelector(".nTileContentWrapper"),k=i.margin=i.margin||parseInt(j.style.margin.replace("px",""),10),l=parseInt(j.style.margin.replace("px",""),10),m=a?0:k,n=m-l;if("Yes"!==c&&"1"!==c)var o=b.querySelector(".nTileSliderContent"),p=i.top=i.top||parseInt(o.style.top.replace("px",""),10),q=parseInt(o.style.top.replace("px",""),10),r=a?0:p,s=r-q;("Yes"===d||"1"===d||"Yes"!==c&&"1"!==c)&&(i.animationID=h.start(a?g.animationTime:g.animationTime<500?2*g.animationTime:1e3,function(a){j&&(j.style.margin=l+a*n+"px"),o&&(o.style.top=q+a*s+"px")},a?g.animationTypeOn:g.animationTypeOff))};e.setup=function(b,c,d){d=d||{},f[b]={webURL:d.webURL||_spPageContextInfo.webServerRelativeUrl,holderID:b,groupName:c,animationTime:parseInt(d.animationTime,10)||a,animationTypeOn:d.animationTypeOn&&d.animationTypeOn in i&&d.animationTypeOn||"slide",animationTypeOff:d.animationTypeOff&&d.animationTypeOff in i&&d.animationTypeOff||"bounce",tilesWrapper:document.getElementById(b),gridBoxDimensions:{width:25,height:25},tiles:{}},f[b].siteURL=(location.protocol+"//"+location.hostname+f[b].webURL).replace(/\/$/,""),d.onclick&&("string"==typeof d.onclick?"[object Function]"==={}.toString.call(window[d.onclick])&&(f[b].onclick=window[d.onclick]):"[object Function]"==={}.toString.call(d.onclick)&&(f[b].onclick=d.onclick))},e.init=function(a,c,g){var h=document.getElementById(a);if(h){e.setup(a,c,g);var i=f[a];h.className+=(h.className?" ":"")+"nTilesWrapper",h.innerHTML='<div class="nTilesContainer">Loading...</div>',p(a,!1,function(c){2==c?(h.innerHTML="",j("input",h,null,{value:"List '"+b+"' does not exist at '"+i.siteURL+"'. Click here to create it.",type:"button",onclick:function(){var a="";return a+='<AddList xmlns="http://schemas.microsoft.com/sharepoint/soap/">',a+="<listName>"+b+"</listName>",a+="<description>List used to house tile configuration for nTiles.</description>",a+="<templateID>100</templateID>",a+="</AddList>",k(i.siteURL,"Lists.asmx?op=AddList","http://schemas.microsoft.com/sharepoint/soap/AddList",a,function(c){c?(h.innerHTML="List '"+b+"' created. Updating list...",setTimeout(function(){a="",a+='<UpdateList xmlns="http://schemas.microsoft.com/sharepoint/soap/">',a+="<listName>"+b+"</listName>",a+="<listProperties>",a+='<List EnableAttachments="FALSE" OnQuickLaunch="TRUE" Description="List used to house tile configuration for nTiles. (v1.4)" />',a+="</listProperties>",a+="<newFields>",a+="<Fields>";for(var c=0,e=d.length;c<e;++c){var f=d[c];f.Name="n"+f.DisplayName.replace(/\b\w/g,function(a){return a.toUpperCase()}).replace(/[^a-zA-Z]/g,""),a+='<Method ID="'+(c+2)+'"'+("Calculated"!=f.Type?' AddToView=""':"")+'><Field Type="'+f.Type+'" DisplayName="'+f.Name+'" '+("Calculated"==f.Type?'ResultType="'+f.ReturnType+'"><Formula>=1</Formula></Field>':"/>")+"</Method>"}a+="</Fields>",a+="</newFields>",a+="<updateFields>",a+="<Fields>",a+='<Method ID="1">',a+='<Field Type="Text" Name="Title" DisplayName="group name" Required="TRUE" Description="the name of the group this tile belongs to"/>',a+="</Method>";for(var c=0,e=d.length;c<e;++c){var f=d[c];a+='<Method ID="'+(d.length+c+2)+'"><Field Type="'+f.Type+'" Name="'+f.Name+'"';for(var g in f)if(f.hasOwnProperty(g)){if("Type"==g||"Name"==g||"Default"==g||"Validation"==g||"Choices"==g||"Formula"==g)continue;a+=" "+g+'="'+f[g]+'"'}if(a+=">",f.hasOwnProperty("Formula")&&(a+="<Formula>"+f.Formula.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</Formula>"),f.hasOwnProperty("Default")&&(a+="<Default>"+f.Default+"</Default>"),f.hasOwnProperty("Validation")&&(a+='<Validation Message="'+f.Validation.Message+'">'+f.Validation.Function+"</Validation>"),f.hasOwnProperty("Choices")){if(a+="<CHOICES>","number"==typeof f.Choices){a+="<CHOICE>none</CHOICE>";for(var j=0;j<=f.Choices;++j)a+="<CHOICE>"+j+"</CHOICE>"}else a+="<CHOICE>"+f.Choices.split(",").join("</CHOICE><CHOICE>")+"</CHOICE>";a+="</CHOICES>"}a+="</Field></Method>"}a+="</Fields>",a+="</updateFields>",a+="</UpdateList>",k(i.siteURL,"Lists.asmx?op=UpdateList","http://schemas.microsoft.com/sharepoint/soap/UpdateList",a,function(a,b){a?(alert("Finished creating and updating the list.\nReloading the page.\nHappy tiling!"),location.reload()):h.innerHTML="Unable to add fields to the list."})},1)):h.innerHTML="Unable to create the list."}),!1}})):3==c?alert("The webURL provided does not exist.\n\n"+i.webURL):4==c?alert("There has been an unknown error. Please report it."):0===c&&ExecuteOrDelayUntilScriptLoaded(function(){var c=new SP.ClientContext(i.webURL),d=c.get_web().get_lists().getByTitle(b);c.load(d),c.load(d,"EffectiveBasePermissions"),c.executeQueryAsync(Function.createDelegate(this,function(){d.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)&&j("span",h,"nTileAdminLinks",{innerHTML:'<span class="nTileAdminLinksOff">...</span><span class="nTileAdminLinksOn"><b>actions</b>:&nbsp;<a href="#" title="add a tile" onclick="nSPTiles.addOrMoveTile(this, \'New\', \''+a+'\'); return false;">add</a>&nbsp;|&nbsp;<a href="#" title="move a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Update\', \''+a+'\'); return false;">move</a>&nbsp;|&nbsp;<a href="#" title="clone a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Clone\', \''+a+'\'); return false;">clone</a>&nbsp;|&nbsp;<a href="#" title="edit a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Edit\', \''+a+'\'); return false;">edit</a>&nbsp;|&nbsp;<a href="#" title="delete a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Delete\', \''+a+'\'); return false;">delete</a>&nbsp;|&nbsp;<a target="_blank" href="'+i.siteURL+"/Lists/"+b+"?FilterField1=LinkTitle&FilterValue1="+i.groupName+'">list</a></span>'})}),Function.createDelegate(this,function(){}))},"sp.js")})}else"complete"==document.readyState?alert("An element with the ID '"+a+"' was not found."):document.addEventListener?document.addEventListener("DOMContentLoaded",function(){e.init(a,c,g)}):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e.init(a,c,g)})},e.addOrMoveTile=function(a,c,d,e,h){a.parentNode.style.display="none";var i=f[d],n=i.tilesWrapper,s=j("div",n,"nTileOverlay"),t=j("div",n,"nTileGridBox",{style:"width: "+i.gridBoxDimensions.width+"px; height: "+i.gridBoxDimensions.height+"px;"}),u=j("div",document.body,null,{id:"nTilesHelp",innerHTML:"<b>Click</b> where you want the <u>top left</u> of the tile to be.<br /><br /><table><tr><td colspan='2'>box dimensions:</td></tr><tr><th>width</th><td><a href='#'>"+i.gridBoxDimensions.width+"</a></td></tr><tr><th>height</th><td><a href='#'>"+i.gridBoxDimensions.height+"</a></td></tr><tr><td colspan='2'>click on the # to change</td></tr></table><br />Press <u>escape</u> to cancel."}),v=j("div",document.body,null,{id:"nTilesToolTip",innerHTML:'left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'}),w=document.getElementById("nTilesToolTipLeft"),x=document.getElementById("nTilesToolTipTop"),y=document.getElementById("nTilesToolTipWidth"),z=document.getElementById("nTilesToolTipHeight"),A=n.offsetHeight,B=function(a,b){var c=prompt("Please enter a new "+b+":",i.gridBoxDimensions[b]);if(null!==c)return isNaN(c)?(alert("Please enter a valid number."),B(a,b)):(i.gridBoxDimensions[b]=parseInt(c,10),a.innerText=i.gridBoxDimensions[b],t.style[b]=i.gridBoxDimensions[b]+"px"),!1},C=u.querySelectorAll("a");C[0].onclick=function(){return B(this,"width"),!1},C[1].onclick=function(){return B(this,"height"),!1};var D=function(){document.onkeyup=C[0].onclick=C[1].onclick=t.onclick=n.onmousemove=null,g(C[0]),g(C[1]),g(s),g(t),g(u),g(w),g(x),g(y),g(z),g(v),q(n,!1),e&&(e.className=e.className.replace(/\ nTileFocus/,"")),n.style.height=A,a.parentNode.style.display=""};t.onclick=function(){t.className+=" nTileGridBoxClicked";var a=w.innerText,e=x.innerText;t.onclick=function(){var f=y.innerText,g=z.innerText,j={ID:"New"==c||"Clone"==c?"New":h,Title:i.groupName};if("Clone"==c){j.nTileBackgroundColor=j.nTileImagePadding=j.nTileFAPadding=j.nHeadingContent=j.nHeadingFontColor=j.nHeadingFontSize=j.nHeadingPadding=j.nSliderHeadingHeight=j.nSliderBodyContent=j.nSliderBodyFontColor=j.nSliderBodyFontSize=j.nSliderBodyPadding=j.nSliderBackgroundColor=j.nSliderBackgroundColor="";var m="";m+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">',m+="<listName>"+b+"</listName>",m+='<query><Query><Where><And><And><Eq><FieldRef Name="Title" /><Value Type="Text">'+i.groupName+'</Value></Eq><Eq><FieldRef Name="nActive" /><Value Type="Boolean">1</Value></Eq></And><Eq><FieldRef Name="ID" /><Value Type="Counter">'+h+"</Value></Eq></And></Where></Query></query>",m+="<viewFields><ViewFields>"+o()+"</ViewFields></viewFields>",m+="<rowLimit>0</rowLimit>",m+="</GetListItems>",k(i.siteURL,"Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",m,function(a,b){for(var d,c=l(b.responseXML,"row","z")[0].attributes,e=0,f=c.length;e<f;++e)(d=c[e].name.match(/ows_(n(?!Cc).*)/))&&(j[d[1]]=c[e].value);j.nHeadingContent=j.nHeadingContent.replace(/[\x26\x0A\<>'"]/g,function(a){return"&#"+a.charCodeAt(0)+";"}),j.nSliderBodyContent=j.nSliderBodyContent.replace(/[\x26\x0A\<>'"]/g,function(a){return"&#"+a.charCodeAt(0)+";"})}),c="New"}j.nTileWidth=f,j.nTileHeight=g,j.nTileLeftOffset=a,j.nTileTopOffset=e,r(i.siteURL,c,j,function(a,b){D(),a?p(d,!0,function(a){0!==a&&alert("There was an error reloading the data which is odd cause it worked on loading.")}):alert("Unable to "+("New"==c?"add a new":"update existing")+" tile.")})},n.onmousemove=function(b){var c=m(b,n),d=(Math.floor((c.elementX-a)/i.gridBoxDimensions.width)+1)*i.gridBoxDimensions.width,f=(Math.floor((c.elementY-e)/i.gridBoxDimensions.height)+1)*i.gridBoxDimensions.height;d>0&&(v.style.left=c.pageX+25+"px",y.innerText=d,t.style.width=d+"px"),f>0&&(v.style.top=c.pageY+25+"px",z.innerText=f,t.style.height=f+"px")},u.querySelector("u").innerText="bottom right",g(u.querySelector("table").rows[3]),C[0].removeAttribute("href"),C[1].removeAttribute("href"),C[0].onclick=C[1].onclick=null},n.onmousemove=function(a){var b=m(a,n),c=Math.floor(b.elementY/i.gridBoxDimensions.height)*i.gridBoxDimensions.height,d=Math.floor(b.elementX/i.gridBoxDimensions.width)*i.gridBoxDimensions.width;t.style.top=c+"px",t.style.left=d+"px",v.style.top=b.pageY+25+"px",v.style.left=b.pageX+25+"px",w.innerText=d,x.innerText=c},q(n,!0),"Update"==c?(e.className+=" nTileFocus",e.querySelector(".nTileHoverBox").innerText="moving"):"Clone"==c&&(e.className+=" nTileFocus",e.querySelector(".nTileHoverBox").innerText="cloning"),document.onkeyup=function(a){27==(a||window.event).keyCode&&D()},n.style.height=A+500+"px"},e.moveCloneEditOrDeleteTile=function(a,c,d){a.parentNode.style.display="none",e.hover=e.openLink=function(){};var h=f[d],i=h.tilesWrapper,k=j("div",document.body,null,{id:"nTilesHelp",innerHTML:"<b>Click</b> on the tile you want to <u>"+c+"</u>.<br /><br />Press <u>escape</u> to cancel."}),l=j("div",document.body,null,{id:"nTilesToolTip",style:"display: none;",innerHTML:"<b>action&nbsp;: <span>"+c+'</span><br />ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipID"></span></b><br /><br /><br />left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'}),n=document.getElementById("nTilesToolTipID"),o=document.getElementById("nTilesToolTipLeft"),u=document.getElementById("nTilesToolTipTop"),v=document.getElementById("nTilesToolTipWidth"),w=document.getElementById("nTilesToolTipHeight");e.hover=function(a,b){a?(b.className+=" nTileFocus",l.style.display="block",n.innerText=b.className.match(/nTile_(\d+)/)[1],o.innerText=b.style.left.replace("px",""),u.innerText=b.style.top.replace("px",""),v.innerText=b.style.width.replace("px",""),w.innerText=b.style.height.replace("px","")):(l.style.display="none",b.className=b.className.replace(/\ nTileFocus/,""))},e.openLink=function(f){var g=n.innerText;f.className=f.className.replace(/\ nTileFocus/,""),x(),"Edit"==c?e.openLink(f,"dialog (refresh tiles after save)",h.siteURL+"/Lists/"+b+"/EditForm.aspx?ID="+g):"Delete"==c?confirm("Are you sure you want to delete the tile?")&&r(h.siteURL,c,{ID:g},function(a){a?p(d,!0,function(a){0!==a&&alert("There was an error reloading the data which is odd cause it worked on loading.")}):alert("Unable to delete the tile.")}):e.addOrMoveTile(a,c,d,f,g)};var x=function(){document.onkeyup=null,g(k),g(n),g(o),g(u),g(v),g(w),g(l),q(i,!1),e.openLink=s,e.hover=t,a.parentNode.style.display=""};q(i,!0,"cell",function(a){var b=m(a,i);l.style.top=b.pageY+25+"px",l.style.left=b.pageX+25+"px"}),document.onkeyup=function(a){27==(a||window.event).keyCode&&x()}};var u=j("style",document.head||document.getElementsByTagName("head")[0],{type:"text/css"});return u.styleSheet?u.styleSheet.cssText=c:u.appendChild(document.createTextNode(c)),e}();
