/* nSPTiles 1.0 | https://github.com/imthenachoman/nSPTiles | Copyright (c) 2015 Anchal Nigam (imthenachoman@gmail.com)| MIT license (http://opensource.org/licenses/mit) */
var nSPTiles=nSPTiles||(function(){"use strict";var N=150;var O="nSPTiles1";var P=".nTilesWrapper,.nTilesContainer,.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{margin:0;padding:0;overflow:hidden}.nTilesWrapper{position:relative}.nTilesContainer{position:relative;display:inline-block}.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{position:absolute;top:0;left:0;bottom:0;right:0}.nTilePositionTable{position:absolute;display:table;width:100%;height:100%}.nTilePositionRow{display:table-row}.nTilePositionCell{display:table-cell;width:100%;height:100%}.nHoverOption1,.nTileHovering .nHoverOption2{display:inline-block!important}.nHoverOption2,.nTileHovering .nHoverOption1{display:none!important}.nTileSliderContent{position:absolute;height:100%;width:100%}.nTileLink{cursor:pointer}.nTileAdminLinks{position:absolute;top:0;right:0;padding:5px;display:none;z-index:50;background-color:#ff9;border:1px solid #000;filter:alpha(opacity=30);opacity:.3}.nTilesWrapper:hover .nTileAdminLinks{display:inline-block}.nTileAdminLinks:hover{filter:(alpha=100);opacity:1}.nTileGridBox{position:absolute;filter:alpha(opacity=30);opacity:.3;background-color:#f00;z-index:100;top:0;left:0}.nTileGridBox.nTileGridBoxClicked{background-color:blue}.nTileOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0f0;filter:alpha(opacity=10);opacity:.1;z-index:95}#nTilesHelp{position:fixed;top:10px;left:10px;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}#nTilesToolTip{font-family:'Lucida Console';position:fixed;top:0;left:0;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}.nTileHoverBox{position:absolute;top:0;left:0;width:100%;height:100%;z-index:50;background-color:#ff0;filter:alpha(opacity=50);opacity:.5}.nTileFocus .nTileHoverBox{background-color:#0ff;font-weight:700;text-decoration:underline}#nTilesHelp table{border-collapse:collapse}#nTilesHelp th, #nTilesHelp td{padding:5px}#nTilesHelp th{text-align:right}";var Q=[{DisplayName:"active",Type:"Boolean",Description:"can be used hide a tile without having to remove this entry",Default:"1"},{DisplayName:"tile width",Type:"Number",Description:"the width of the tile in px",Default:"100",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile height",Type:"Number",Description:"the height of the tile in px",Default:"100",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile left offset",Type:"Number",Description:"the left offset of the tile in px",Default:"0",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile top offset",Type:"Number",Description:"the top offset of the tile in px",Default:"0",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile border width",Type:"Number",Description:"the empty space around the tile in px",Default:"2",Required:"TRUE",Min:"0",Decimals:"0"},{DisplayName:"tile zoom on hover",Type:"Boolean",Description:"zoom effect for the tile by making the tile border width 0 when the mouse is over the tile",Default:"1",Required:"FALSE"},{DisplayName:"tile link type",Type:"Choice",Description:"the type of link to make",Default:"none",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"none,current window,new window,dialog,dialog (refresh window after save),dialog (refresh tiles after save)"},{DisplayName:"tile link URL",Type:"Note",Description:"the URL for the link",Required:"FALSE",NumLines:"3",RichText:"FALSE"},{DisplayName:"is heading",Type:"Boolean",Description:"heading tiles have no slider",Default:"0"},{DisplayName:"tile background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"rgb(0,114,198)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Default:"none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile background color on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile background opacity on hover",Type:"Choice",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image URL",Type:"Text",Description:"URL of image to use in tile (must be less then 255 characters)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image width",Type:"Text",Description:"width of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image width]="",AND(ISNUMBER([tile image width]+0),ROUND([tile image width]+0,0)=([tile image width]+0)),AND(RIGHT([tile image width],1)="%",ISNUMBER(LEFT([tile image width],LEN([tile image width])-1)+0)))'}},{DisplayName:"tile image height",Type:"Text",Description:"height of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image height]="",AND(ISNUMBER([tile image height]+0),ROUND([tile image height]+0,0)=([tile image height]+0)),AND(RIGHT([tile image height],1)="%",ISNUMBER(LEFT([tile image height],LEN([tile image height])-1)+0)))'}},{DisplayName:"tile image opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image padding",Type:"Number",Description:"how far from the edge of the tile should the image be in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"tile image style",Type:"Text",Description:"css style to apply to the tile image (overrides above tile image options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image position",Type:"Choice",Description:"position of the image in the tile",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile image URL on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA class",Type:"Text",Description:"Font Awesome icon class name",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile FA padding",Type:"Number",Description:"how far from the edge of the tile should the icon be in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"tile FA style",Type:"Text",Description:"css style to apply to the FA icon (overrides above tile FA options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA position",Type:"Choice",Description:"position of the icon in the tile",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile FA class on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading content",Type:"Text",Description:"can use HTML",Default:"heading",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading bolded",Type:"Boolean",Description:"should the heading text be bold",Default:"1"},{DisplayName:"heading font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"white",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading font size",Type:"Number",Description:"font size for the heading in px",Default:"10",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"heading padding",Type:"Number",Description:"padding for the heading in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"heading style",Type:"Text",Description:"css style to apply to heading (overrides above heading options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading position",Type:"Choice",Description:"position of the heading in the tile or slider heading",Default:"bottom left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"heading content on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading style on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider heading height",Type:"Number",Description:"height of the header for the slider in px",Default:"25",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body content",Type:"Note",Description:"can use HTML",Default:"body",Required:"FALSE",NumLines:"5",RichText:"FALSE"},{DisplayName:"slider body font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"white",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider body font size",Type:"Number",Description:"font size for the slider body in px",Default:"10",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body padding",Type:"Number",Description:"padding of the slider body in px",Default:"5",Required:"FALSE",Min:"0",Decimals:"0"},{DisplayName:"slider body style",Type:"Text",Description:"css style to apply to slider body (overrides above slider body options)",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider body position",Type:"Choice",Description:"position of the slider body in the slider",Default:"top left",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"slider background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Default:"black",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Default:"50",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"slider background color on hover",Type:"Text",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background opacity on hover",Type:"Choice",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image and FA slider heading push",Type:"Boolean",Description:"if the tile image and/or FA are positioned on the bottom then push them on top of the slider heading",Default:"1"},{DisplayName:"tile custom ID",Type:"Text",Description:"custom ID to use for the tile &#xD;&#xA;&#xD;&#xA;default is nTile_[ID] where ID is the ID of the entry in the list",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile custom class(es)",Type:"Text",Description:"custom class(s) to add to the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"cc tile style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("width: ",[tile width],"px; height: ",[tile height],"px; top: ",[tile top offset],"px; left: ",[tile left offset],"px;")'},{DisplayName:"cc tile content wrapper style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("margin: ",[tile border width],"px;")'},{DisplayName:"cc tile right edge",Type:"Calculated",Decimals:"0",ResultType:"Number",Formula:'=[tile left offset]+[tile width]'},{DisplayName:"cc tile bottom edge",Type:"Calculated",Decimals:"0",ResultType:"Number",Formula:'=[tile top offset]+[tile height]'},{DisplayName:"cc tile background class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]&lt;&gt;"","nTileBackground"&amp;IF([tile background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([tile background color],1)="."," "&amp;REPLACE([tile background color],1,1,""),""),"")'},{DisplayName:"cc tile background style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]&lt;&gt;"",IF(AND([tile background opacity]&lt;&gt;"",[tile background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity]&amp;"); opacity: "&amp;[tile background opacity]/100&amp;"; ","")&amp;IF(AND([tile background color]&lt;&gt;"",LEFT([tile background color],1)&lt;&gt;"."),"background-color: "&amp;[tile background color]&amp;"; ",""),"")'},{DisplayName:"cc tile background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([tile background color on hover],1)="."," "&amp;REPLACE([tile background color on hover],1,1,""),""),"")'},{DisplayName:"cc tile background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),IF(AND([tile background opacity on hover]&lt;&gt;"",[tile background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity on hover]&amp;"); opacity: "&amp;[tile background opacity on hover]/100&amp;"; ","")&amp;IF(AND([tile background color on hover]&lt;&gt;"",LEFT([tile background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[tile background color on hover]&amp;"; ",""),"")'},{DisplayName:"cc tile image and fa table style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image and FA slider heading push],NOT([is heading]),OR([tile image URL]&lt;&gt;"",[tile FA class]&lt;&gt;"")),"height: 0;","")'},{DisplayName:"cc tile image position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"","vertical-align: "&amp;LEFT([tile image position],SEARCH(" ",[tile image position])-1)&amp;"; text-align: "&amp;RIGHT([tile image position],LEN([tile image position])-SEARCH(" ",[tile image position]))&amp;"; "&amp;IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&amp;[tile height]-[tile border width]-[tile border width]-[slider heading height]&amp;"px",""),"")'},{DisplayName:"cc tile image class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"","nTileImage"&amp;IF([tile image URL on hover]&lt;&gt;""," nHoverOption1",""),"")'},{DisplayName:"cc tile image style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"",IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity]&lt;&gt;"",[tile image opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity]&amp;"); opacity: "&amp;[tile image opacity]/100&amp;"; ","")&amp;[tile image style],"")'},{DisplayName:"cc tile image class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),"nTileImage nHoverOption2","")'},{DisplayName:"cc tile image style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity]&lt;&gt;"",[tile image opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity]&amp;"); opacity: "&amp;[tile image opacity]/100&amp;"; ","")&amp;[tile image style on hover],"")'},{DisplayName:"cc tile FA position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"","vertical-align: "&amp;LEFT([tile FA position],SEARCH(" ",[tile FA position])-1)&amp;"; text-align: "&amp;RIGHT([tile FA position],LEN([tile FA position])-SEARCH(" ",[tile FA position]))&amp;"; "&amp;IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&amp;[tile height]-[tile border width]-[tile border width]-[slider heading height]&amp;"px",""),"")'},{DisplayName:"cc tile FA class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"","nTileFA fa "&amp;[tile FA class]&amp;IF([tile FA class on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)=".")," "&amp;REPLACE([tile FA color],1,1,""),""),"")'},{DisplayName:"cc tile FA style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"",IF(AND([tile FA opacity]&lt;&gt;"",[tile FA opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity]&amp;"); opacity: "&amp;[tile FA opacity]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px; ","")&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)&lt;&gt;"."),"color: "&amp;[tile FA color]&amp;";","")&amp;[tile FA style],"")'},{DisplayName:"cc tile FA class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),"nTileFA fa "&amp;[tile FA class on hover]&amp;" nHoverOption2"&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)=".")," "&amp;REPLACE([tile FA color],1,1,""),""),"")'},{DisplayName:"cc tile FA style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),IF(AND([tile FA opacity]&lt;&gt;"",[tile FA opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity]&amp;"); opacity: "&amp;[tile FA opacity]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px; ","")&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)&lt;&gt;"."),"color: "&amp;[tile FA color]&amp;"; ","")&amp;[tile FA style on hover],"")'},{DisplayName:"cc heading position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"","vertical-align: "&amp;LEFT([heading position],SEARCH(" ",[heading position])-1)&amp;"; text-align: "&amp;RIGHT([heading position],LEN([heading position])-SEARCH(" ",[heading position]))&amp;"; "&amp;IF(NOT([is heading]),"height: "&amp;[slider heading height]&amp;"px; ",""),"")'},{DisplayName:"cc heading class",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"","nTileHeading"&amp;IF([heading content on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([heading font color])="."," "&amp;REPLACE([heading font color],1,1,""),""),"")'},{DisplayName:"cc heading style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"",IF([heading bolded],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color]&lt;&gt;"",LEFT([heading font color],1)&lt;&gt;"."),"color: "&amp;[heading font color]&amp;"; ","")&amp;[heading style],"")'},{DisplayName:"cc heading class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),"nTileHeading nHoverOption2"&amp;IF(LEFT([heading font color])="."," "&amp;REPLACE([heading font color],1,1,""),""),"")'},{DisplayName:"cc heading style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),IF([heading bolded],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color]&lt;&gt;"",LEFT([heading font color],1)&lt;&gt;"."),"color: "&amp;[heading font color]&amp;"; ","")&amp;[heading style on hover],"")'},{DisplayName:"cc slider content style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),CONCATENATE("top: ",[tile height]-[tile border width]-[tile border width]-[slider heading height],"px;"),"")'},{DisplayName:"cc slider position style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"vertical-align: "&amp;LEFT([slider body position],SEARCH(" ",[slider body position])-1)&amp;"; text-align: "&amp;RIGHT([slider body position],LEN([slider body position])-SEARCH(" ",[slider body position]))&amp;"; ","")'},{DisplayName:"cc slider body class",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"nTileSlider"&amp;IF(LEFT([slider body font color],1)="."," "&amp;REPLACE([slider body font color],1,1,""),""),"")'},{DisplayName:"cc slider body style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),[slider body style]&amp;"; "&amp;IF([slider body padding]&lt;&gt;"","padding: "&amp;[slider body padding]&amp;"px; ","")&amp;IF([slider body font size]&lt;&gt;"","font-size: "&amp;[slider body font size]&amp;"px; ","")&amp;IF(AND([slider body font color]&lt;&gt;"",LEFT([slider body font color],1)&lt;&gt;"."),"color: "&amp;[slider body font color]&amp;"; ",""),"")'},{DisplayName:"cc slider background class",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),"nTileBackground"&amp;IF([slider background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([slider background color],1)="."," "&amp;REPLACE([slider background color],1,1,""),""),"")'},{DisplayName:"cc slider background style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),IF(AND([slider background opacity]&lt;&gt;"",[slider background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity]&amp;"); opacity: "&amp;[slider background opacity]/100&amp;"; ","")&amp;IF(AND([slider background color]&lt;&gt;"",LEFT([slider background color],1)&lt;&gt;"."),"background-color: "&amp;[slider background color]&amp;"; ",""),"")'},{DisplayName:"cc slider background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([slider background color on hover],1)="."," "&amp;REPLACE([slider background color on hover],1,1,""),""),"")'},{DisplayName:"cc slider background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),IF(AND([slider background opacity on hover]&lt;&gt;"",[slider background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity on hover]&amp;"); opacity: "&amp;[slider background opacity on hover]/100&amp;"; ","")&amp;IF(AND([slider background color on hover]&lt;&gt;"",LEFT([slider background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[slider background color on hover]&amp;"; ",""),"")'}];var R={};var S={};var T=function(a){a.parentNode.removeChild(a)};var U=(function(){var h=0,animationIDTracker={},lastTime=0,vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame']}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(a){var b=new Date().getTime();var c=Math.max(0,16-(b-lastTime));var d=window.setTimeout(function(){a(b+c)},c);lastTime=b+c;return d}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(a){clearTimeout(a)}}return{stop:function(a){cancelAnimationFrame(animationIDTracker[a]);delete animationIDTracker[a]},start:function(b,c,d){var e=h++;var f=+new Date();var g=function(){var a=+new Date()-f;if(a>=b){c(1);U.stop(e)}else{c(V[d](a,0,1,b));animationIDTracker[e]=requestAnimationFrame(g)}};g();return e}}})();var V={slide:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},bounce:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}},elastic:function(t,b,c,d){var s=1.70158;var p=0;var a=c;if(t===0)return b;if((t/=d)==1)return b+c;if(!p)p=d*0.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b}};var W=function(a,b,c,d){var e=document.createElement(a);if(c){e.className=c}if(d){for(var f in d){if(/^(inner|on)\w+$/i.test(f)){e[f]=d[f]}else{e.setAttribute(f,d[f])}}}if(b){b.appendChild(e)}return e};var X=function(a,b,c,d,e,f){var g=typeof XMLHttpRequest!='undefined'?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');g.open("post",a+"/_vti_bin/"+b,typeof(f)!=="undefined"&&f!==null?f:false);g.setRequestHeader("SOAPAction",c);g.setRequestHeader("Content-Type","text/xml; charset=\"utf-8\"");g.onreadystatechange=function(){if(g.readyState==4){window.xhr=g;e(g.status==200,g)}};g.send('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>'+d+'</soap:Body></soap:Envelope>')};var Y=function(a,b,c){return a.getElementsByTagNameNS?a.getElementsByTagNameNS("*",b):a.getElementsByTagName(c+":"+b)};var Z=function(e,a){var e=e||window.event;var c={pageX:0,pageY:0,elementX:0,elementY:0};if(e.pageX||e.pageY){c.pageX=e.pageX;c.pageY=e.pageY}else if(e.clientX||e.clientY){c.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}if(a){var b=a.getBoundingClientRect();c.elementX=c.pageX-b.left;c.elementY=c.pageY-b.top}return c};var ba=function(a,b,c,d,e,f){var g='<div class="nTilePositionTable '+a+'" style="'+b+'">';g+='<div class="nTilePositionRow nTilePositionRow1"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+c+';">'+d+'</div></div>';if(e){g+='<div class="nTilePositionRow nTilePositionRow2"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+e+'">'+f+'</div></div>'}return g+'</div>'};var bb=function(){var a="";a='<FieldRef Name="ID" />';for(var i=0,num=Q.length;i<num;++i){a+='<FieldRef Name="'+"n"+Q[i].DisplayName.replace(/\b\w/g,function(m){return m.toUpperCase()}).replace(/[^a-zA-Z]/g,"")+'" />'}return a};var bc=function(F,G,H){var I=S[F];var J=I.tilesWrapper;var K=J.querySelector(".nTilesContainer");I.tiles={};var L=K.querySelectorAll(".nTile");for(var i=0,num=L.length;i<num;++i){L[i].onclick=L[i].onmouseenter=L[i].onmouseleave=null}K.innerText="Please wait while I reload the data...";var M='';M+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';M+='<listName>'+O+'</listName>';M+='<query><Query><Where><And><Eq><FieldRef Name="Title"/><Value Type="Text">'+I.groupName+'</Value></Eq><Eq><FieldRef Name="nActive"/><Value Type="Boolean">1</Value></Eq></And></Where></Query></query>';M+='<viewFields><ViewFields>'+bb()+'</ViewFields></viewFields>';M+='<rowLimit>0</rowLimit>';M+='</GetListItems>';X(I.siteURL,"Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",M,function(a,b){if(!a){if(H){if(/<errorcode.*?>0x82000006<\/errorcode>/i.test(b.responseText)){H(2)}else if(/there is no web named/i.test(b.responseText)){H(3)}else{if(console.log)console.log(b.responseText);H(4)}}return}var c=Y(b.responseXML,"row","z");var d="";var e=100;var f=100;if(c.length){var g=-1;var h=-1;for(var i=0,num=c.length;i<num;++i){var j=c[i];var k="";var l=parseInt(j.getAttribute("ows_nCcTileRightEdge").replace(/^[a-z]*?;#/i,""),10);var m=parseInt(j.getAttribute("ows_nCcTileBottomEdge").replace(/^[a-z]*?;#/i,""),10);var n=j.getAttribute("ows_nCcTileBackgroundClass").replace(/^[a-z]*?;#/i,"");var o=j.getAttribute("ows_nCcTileBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var p=j.getAttribute("ows_nCcTileFAClass").replace(/^[a-z]*?;#/i,"");var q=j.getAttribute("ows_nCcTileFAClassOnHover").replace(/^[a-z]*?;#/i,"");var r=j.getAttribute("ows_nCcHeadingPositionStyle").replace(/^[a-z]*?;#/i,"");var s=j.getAttribute("ows_nCcHeadingClass").replace(/^[a-z]*?;#/i,"");var t=j.getAttribute("ows_nCcHeadingStyle").replace(/^[a-z]*?;#/i,"");var u=j.getAttribute("ows_nCcHeadingClassOnHover").replace(/^[a-z]*?;#/i,"");var v=j.getAttribute("ows_nCcHeadingStyleOnHover").replace(/^[a-z]*?;#/i,"");var w=j.getAttribute("ows_nCcSliderBackgroundClass").replace(/^[a-z]*?;#/i,"");var x=j.getAttribute("ows_nCcSliderBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var y=(j.getAttribute("ows_nTileCustomClassEs")||"")+" nTile nTile_"+j.getAttribute("ows_ID");var z="nSPTiles.hover(true, this, '"+j.getAttribute("ows_nIsHeading")+"', '"+j.getAttribute("ows_nTileZoomOnHover")+"')";var A="nSPTiles.hover(false, this, '"+j.getAttribute("ows_nIsHeading")+"', '"+j.getAttribute("ows_nTileZoomOnHover")+"')";if(j.getAttribute("ows_nTileLinkType")!="none"){y+=" nTileLink"}var B="nSPTiles.openLink(this, '"+j.getAttribute("ows_nTileLinkType")+"', '"+(j.getAttribute("ows_nTileLinkURL")?j.getAttribute("ows_nTileLinkURL").replace(/\s|\r|\n/g,""):j.getAttribute("ows_nTileLinkURL"))+"')";if(g<l){g=l}if(h<m){h=m}k+='<div class="nTileContentWrapper" style="'+j.getAttribute("ows_nCcTileContentWrapperStyle").replace(/^[a-z]*?;#/i,"")+'">';if(n){k+='<div class="'+n+'" style="'+(j.getAttribute("ows_nCcTileBackgroundStyle").replace(/^[a-z]*?;#/i,""))+'"></div>';if(o){k+='<div class="'+o+'" style="'+(j.getAttribute("ows_nCcTileBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></div>'}}if(j.getAttribute("ows_nTileImageURL")){var C='<img class="'+(j.getAttribute("ows_nCcTileImageClass").replace(/^[a-z]*?;#/i,""))+'" style="'+(j.getAttribute("ows_nCcTileImageStyle").replace(/^[a-z]*?;#/i,""))+'" src="'+j.getAttribute("ows_nTileImageURL")+'" />';if(j.getAttribute("ows_nTileImageURLOnHover")){C+='<img class="'+(j.getAttribute("ows_nCcTileImageClassOnHover").replace(/^[a-z]*?;#/i,""))+'" style="'+(j.getAttribute("ows_nCcTileImageStyleOnHover").replace(/^[a-z]*?;#/i,""))+'" src="'+j.getAttribute("ows_nTileImageURLOnHover")+'" />'}k+=ba("nTileImagePositionWrapper",(j.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,"")),(j.getAttribute("ows_nCcTileImagePositionStyle").replace(/^[a-z]*?;#/i,"")),'<div style="line-height: 0;">'+C+'</div>')}if(p){var C='<span class="'+p+'" style="'+(j.getAttribute("ows_nCcTileFAStyle").replace(/^[a-z]*?;#/i,""))+'"></span>';if(q){C+='<span class="'+q+'" style="'+(j.getAttribute("ows_nCcTileFAStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></span>'}k+=ba("nTileFAPositionWrapper",(j.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,"")),(j.getAttribute("ows_nCcTileFAPositionStyle").replace(/^[a-z]*?;#/i,"")),C)}if(j.getAttribute("ows_nIsHeading")=="1"){y+=" nHeadingTile";var C='<div class="'+s+'" style="'+t+'">'+(j.getAttribute("ows_nHeadingContent")||"")+'</div>';if(j.getAttribute("ows_nHeadingContentOnHover")){C+='<div class="'+u+'" style="'+v+'">'+(j.getAttribute("ows_nHeadingContentOnHover")||"")+'</div>'}k+=ba("nTileHeadingPositionWrapper","",r,C)}else{y+=" nSliderTile";k+='<div class="nTileSliderContent" style="'+(j.getAttribute("ows_nCcSliderContentStyle").replace(/^[a-z]*?;#/i,""))+'">';if(w){k+='<div class="'+w+'" style="'+(j.getAttribute("ows_nCcSliderBackgroundStyle").replace(/^[a-z]*?;#/i,""))+'"></div>';if(x){k+='<div class="'+x+'" style="'+(j.getAttribute("ows_nCcSliderBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></div>'}}var D='<div class="'+s+'" style="'+t+'">'+(j.getAttribute("ows_nHeadingContent")||"")+'</div>';if(j.getAttribute("ows_nHeadingContentOnHover")){D+='<div class="'+u+'" style="'+v+'">'+(j.getAttribute("ows_nHeadingContentOnHover")||"")+'</div>'}var E='<div class="'+(j.getAttribute("ows_nCcSliderBodyClass").replace(/^[a-z]*?;#/i,""))+'" style="'+(j.getAttribute("ows_nCcSliderBodyStyle").replace(/^[a-z]*?;#/i,""))+'">'+((j.getAttribute("ows_nSliderBodyContent")||"").replace(/\n/g,'<br />'))+'</div>';k+=ba("nTileSliderPositionWrapper","",r,D,(j.getAttribute("ows_nCcSliderPositionStyle").replace(/^[a-z]*?;#/i,"")),E);k+='</div>'}k+='</div>';d+='<div id="'+(j.getAttribute("ows_nTileCustomID")||"nTile_"+j.getAttribute("ows_ID"))+'" class="'+y+'" style="'+j.getAttribute("ows_nCcTileStyle").replace(/^[a-z]*?;#/i,"")+'" onmouseenter="'+z+'" onmouseleave="'+A+'" onclick="'+B+'">'+k+'</div>'}e=g;f=h;K.innerHTML=d}else{K.innerHTML=""}J.style.height=f+"px";K.style.height=f+"px";K.style.width=e+"px";if(H){H(0)}},G)};var bd=function(a,b,c,d){if(b){var e=a.querySelectorAll(".nTile");var f=W("div",null,"nTileHoverBox",{"style":"text-align: center;","innerText":"tile"});if(c){f.style.cursor=c}for(var i=0,num=e.length;i<num;++i){var g=e[i];var h=f.cloneNode(true);h.style.lineHeight=g.style.height;if(d){h.onmousemove=d}g.appendChild(h)}}else{var j=a.querySelectorAll(".nTileHoverBox");for(var i=0,num=j.length;i<num;++i){var f=j[i];f.onmousemove=null;T(f)}}};var be=function(a,b,c,d){var e='<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';e+='<listName>'+O+'</listName>';e+='<updates>';e+='<Batch OnError="Continue">';e+='<Method ID="1" Cmd="'+b+'">';for(var i in c){if(c.hasOwnProperty(i)){e+='<Field Name="'+i+'">'+c[i]+'</Field>'}}e+='</Method>';e+='</Batch>';e+='</updates>';e+='</UpdateListItems>';X(a,"Lists.asmx?op=UpdateListItems","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",e,d,true)};var bf=R.openLink=function(b,c,d){if(c==="none")return;var e=b.parentNode.parentNode.id;var f={"url":d};switch(c){case"current window":location.href=d;break;case"new window":window.open(d);break;case"dialog":SP.UI.ModalDialog.showModalDialog(f);break;case"dialog (refresh window after save)":f.dialogReturnValueCallback=function(a){if(a==SP.UI.DialogResult.OK){location.href=location.href}};SP.UI.ModalDialog.showModalDialog(f);break;case"dialog (refresh tiles after save)":f.dialogReturnValueCallback=function(a){if(a==SP.UI.DialogResult.OK){bc(b.parentNode.parentNode.id,true)}};SP.UI.ModalDialog.showModalDialog(f);break;default:alert("I don't know how to handle open a link of type '"+c+"'.");break}if(S[e].onclick)S[e].onclick(d,c)};var bg=R.hover=function(b,c,d,e){var f=c.parentNode.parentNode.id;var g=S[f];var h=g.tiles[c.id]=g.tiles[c.id]||{};if(b){c.className+=" nTileHovering"}else{c.className=c.className.replace(/\ nTileHovering/,"")}if("animationID"in h){U.stop(h.animationID)}if(e==="Yes"||e==="1"){var i=c.querySelector(".nTileContentWrapper");var j=h.margin=h.margin||parseInt(i.style.margin.replace("px",""),10);var k=parseInt(i.style.margin.replace("px",""),10);var l=b?0:j;var m=l-k}if(d!=="Yes"&&d!=="1"){var n=c.querySelector(".nTileSliderContent");var o=h.top=h.top||parseInt(n.style.top.replace("px",""),10);var p=parseInt(n.style.top.replace("px",""),10);var q=b?0:o;var r=q-p}if(e==="Yes"||e==="1"||d!=="Yes"&&d!=="1"){h.animationID=U.start(b?g.animationTime:(g.animationTime<500?g.animationTime*2:1000),function(a){if(i){i.style.margin=k+(a*m)+"px"}if(n){n.style.top=p+(a*r)+"px"}},b?g.animationTypeOn:g.animationTypeOff)}};R.setup=function(a,b,c){c=c||{};S[a]={webURL:c.webURL||_spPageContextInfo.webServerRelativeUrl,holderID:a,groupName:b,animationTime:parseInt(c.animationTime,10)||N,animationTypeOn:c.animationTypeOn&&c.animationTypeOn in V&&c.animationTypeOn||"slide",animationTypeOff:c.animationTypeOff&&c.animationTypeOff in V&&c.animationTypeOff||"bounce",tilesWrapper:document.getElementById(a),gridBoxDimensions:{width:25,height:25},tiles:{}};S[a].siteURL=(location.protocol+"//"+location.hostname+S[a].webURL).replace(/\/$/,"");if(c.onclick){if(typeof(c.onclick)==="string"){if({}.toString.call(window[c.onclick])==="[object Function]"){S[a].onclick=window[c.onclick]}}else if({}.toString.call(c.onclick)==='[object Function]'){S[a].onclick=c.onclick}}};R.init=function(h,k,l){var n=document.getElementById(h);if(n){R.setup(h,k,l);var o=S[h];n.className+=(n.className?" ":"")+"nTilesWrapper";n.innerHTML='<div class="nTilesContainer">Loading...</div>';bc(h,false,function(g){if(g==2){n.innerHTML="";W("input",n,null,{value:"List '"+O+"' does not exist. Click here to create it.",type:"button",onclick:function(){var f='';f+='<AddList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+O+'</listName>';f+='<description>List used to house tile configuration for nTiles.</description>';f+='<templateID>100</templateID>';f+='</AddList>';X(o.siteURL,"Lists.asmx?op=AddList","http://schemas.microsoft.com/sharepoint/soap/AddList",f,function(e){if(!e){n.innerHTML="Unable to create the list."}else{n.innerHTML="List '"+O+"' created. Updating list...";setTimeout(function(){f='';f+='<UpdateList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+O+'</listName>';f+='<listProperties>';f+='<List EnableAttachments="FALSE" OnQuickLaunch="TRUE" Description="List used to house tile configuration for nTiles. (v1.0)" />';f+='</listProperties>';f+='<newFields>';f+='<Fields>';for(var i=0,num=Q.length;i<num;++i){var c=Q[i];c.Name="n"+c.DisplayName.replace(/\b\w/g,function(m){return m.toUpperCase()}).replace(/[^a-zA-Z]/g,"");f+='<Method ID="'+(i+2)+'"'+(c.Type!="Calculated"?' AddToView=""':'')+'><Field Type="'+c.Type+'" DisplayName="'+c.Name+'" '+(c.Type=="Calculated"?'ResultType="'+c.ReturnType+'"><Formula>=1</Formula></Field>':'/>')+'</Method>'}f+='</Fields>';f+='</newFields>';f+='<updateFields>';f+='<Fields>';f+='<Method ID="1">';f+='<Field Type="Text" Name="Title" DisplayName="group name" Required="TRUE" Description="the name of the group this tile belongs to"/>';f+='</Method>';for(var i=0,num=Q.length;i<num;++i){var c=Q[i];f+='<Method ID="'+(Q.length+i+2)+'"><Field Type="'+c.Type+'" Name="'+c.Name+'"';for(var d in c){if(c.hasOwnProperty(d)){if(d=="Type"||d=="Name"||d=="Default"||d=="Validation"||d=="Choices"||d=="Formula"){continue}f+=' '+d+'="'+c[d]+'"'}}f+='>';if(c.hasOwnProperty("Formula")){f+='<Formula>'+c.Formula+'</Formula>'}if(c.hasOwnProperty("Default")){f+='<Default>'+c.Default+'</Default>'}if(c.hasOwnProperty("Validation")){f+='<Validation Message="'+c.Validation.Message+'">'+c.Validation.Function+'</Validation>'}if(c.hasOwnProperty("Choices")){f+='<CHOICES>';if(typeof(c.Choices)==="number"){f+='<CHOICE>none</CHOICE>';for(var j=0;j<=c.Choices;++j){f+='<CHOICE>'+j+'</CHOICE>'}}else{f+='<CHOICE>'+c.Choices.split(",").join('</CHOICE><CHOICE>')+'</CHOICE>'}f+='</CHOICES>'}f+='</Field></Method>'}f+='</Fields>';f+='</updateFields>';f+='</UpdateList>';X(o.siteURL,"Lists.asmx?op=UpdateList","http://schemas.microsoft.com/sharepoint/soap/UpdateList",f,function(a,b){if(a){alert("Finished creating and updating the list.\nReloading the page.\nHappy tiling!");location.reload()}else{n.innerHTML="Unable to add fields to the list."}})},1)}});return false}})}else if(g==3){alert("The webURL provided does not exist.\n\n"+o.webURL)}else if(g==4){alert("There has been an unknown error. Please report it.")}else if(g===0){ExecuteOrDelayUntilScriptLoaded(function(){var a=new SP.ClientContext(o.webURL);var b=a.get_web().get_lists().getByTitle(O);a.load(b);a.load(b,'EffectiveBasePermissions');a.executeQueryAsync(Function.createDelegate(this,function(){if(b.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)){W("span",n,"nTileAdminLinks",{"innerHTML":'<b>actions</b>:&nbsp;<a href="#" title="add a tile" onclick="nSPTiles.addOrMoveTile(this, \'New\', \''+h+'\'); return false;">add</a>&nbsp;|&nbsp;<a href="#" title="move a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Update\', \''+h+'\'); return false;">move</a>&nbsp;|&nbsp;<a href="#" title="clone a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'New\', \''+h+'\'); return false;">clone</a>&nbsp;|&nbsp;<a href="#" title="edit a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Edit\', \''+h+'\'); return false;">edit</a>&nbsp;|&nbsp;<a href="#" title="delete a tile" onclick="nSPTiles.moveCloneEditOrDeleteTile(this, \'Delete\', \''+h+'\'); return false;">delete</a>&nbsp;|&nbsp;<a target="_blank" href="'+o.siteURL+'/Lists/'+O+'?FilterField1=LinkTitle&FilterValue1='+o.groupName+'">list</a>'})}}),Function.createDelegate(this,function(){}))},"sp.js")}})}else if(document.readyState=="complete"){alert("An element with the ID '"+h+"' was not found.")}else{if(document.addEventListener){document.addEventListener('DOMContentLoaded',function(){R.init(h,k,l)})}else{document.attachEvent('onreadystatechange',function(){if(document.readyState!='loading'){R.init(h,k,l)}})}}};R.addOrMoveTile=function(a,l,m,n,o){a.parentNode.style.display="none";var p=S[m];var q=p.tilesWrapper;var s=W("div",q,"nTileOverlay");var t=W("div",q,"nTileGridBox",{"style":"width: "+p.gridBoxDimensions.width+"px; height: "+p.gridBoxDimensions.height+"px;"});var u=W("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> where you want the <u>top left</u> of the tile to be.<br /><br /><table><tr><td colspan='2'>box dimensions:</td></tr><tr><th>width</th><td><a href='#'>"+p.gridBoxDimensions.width+"</a></td></tr><tr><th>height</th><td><a href='#'>"+p.gridBoxDimensions.height+"</a></td></tr><tr><td colspan='2'>click on the # to change</td></tr></table><br />Press <u>escape</u> to cancel."});var v=W("div",document.body,null,{"id":"nTilesToolTip","innerHTML":'left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var w=document.getElementById("nTilesToolTipLeft");var x=document.getElementById("nTilesToolTipTop");var y=document.getElementById("nTilesToolTipWidth");var z=document.getElementById("nTilesToolTipHeight");var A=q.offsetHeight;var B=function(a,b){var c=prompt("Please enter a new "+b+":",p.gridBoxDimensions[b]);if(c===null)return;if(isNaN(c)){alert("Please enter a valid number.");B(a,b)}else{p.gridBoxDimensions[b]=parseInt(c,10);a.innerText=p.gridBoxDimensions[b];t.style[b]=p.gridBoxDimensions[b]+"px"}return false};var C=u.querySelectorAll("a");C[0].onclick=function(){B(this,"width");return false};C[1].onclick=function(){B(this,"height");return false};var D=function(){document.onkeyup=C[0].onclick=C[1].onclick=t.onclick=q.onmousemove=null;T(C[0]);T(C[1]);T(s);T(t);T(u);T(w);T(x);T(y);T(z);T(v);bd(q,false);if(n){n.className=n.className.replace(/\ nTileFocus/,"")}q.style.height=A;a.parentNode.style.display=""};t.onclick=function(){t.className+=" nTileGridBoxClicked";var j=w.innerText;var k=x.innerText;t.onclick=function(){var e=y.innerText;var f=z.innerText;var g={"ID":l=="New"?"New":o,"Title":p.groupName};if(l=="New"&&o){g.nTileBackgroundColor=g.nTileImagePadding=g.nTileFAPadding=g.nHeadingContent=g.nHeadingFontColor=g.nHeadingFontSize=g.nHeadingPadding=g.nSliderHeadingHeight=g.nSliderBodyContent=g.nSliderBodyFontColor=g.nSliderBodyFontSize=g.nSliderBodyPadding=g.nSliderBackgroundColor=g.nSliderBackgroundColor="";var h='';h+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';h+='<listName>'+O+'</listName>';h+='<query><Query><Where><And><And><Eq><FieldRef Name="Title" /><Value Type="Text">'+p.groupName+'</Value></Eq><Eq><FieldRef Name="nActive" /><Value Type="Boolean">1</Value></Eq></And><Eq><FieldRef Name="ID" /><Value Type="Counter">'+o+'</Value></Eq></And></Where></Query></query>';h+='<viewFields><ViewFields>'+bb()+'</ViewFields></viewFields>';h+='<rowLimit>0</rowLimit>';h+='</GetListItems>';X(p.siteURL,"Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",h,function(a,b){var c=Y(b.responseXML,"row","z")[0].attributes;var d;for(var i=0,num=c.length;i<num;++i){if(d=c[i].name.match(/ows_(n(?!Cc).*)/)){g[d[1]]=c[i].value}}g.nHeadingContent=g.nHeadingContent.replace(/[\x26\x0A\<>'"]/g,function(r){return"&#"+r.charCodeAt(0)+";"});g.nSliderBodyContent=g.nSliderBodyContent.replace(/[\x26\x0A\<>'"]/g,function(r){return"&#"+r.charCodeAt(0)+";"})})}g.nTileWidth=e;g.nTileHeight=f;g.nTileLeftOffset=j;g.nTileTopOffset=k;be(p.siteURL,l,g,function(b,c){D();if(b){bc(m,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to "+(l=="New"?"add a new":"update existing")+" tile.")}})};q.onmousemove=function(e){var c=Z(e,q);var a=(Math.floor((c.elementX-j)/p.gridBoxDimensions.width)+1)*p.gridBoxDimensions.width;var b=(Math.floor((c.elementY-k)/p.gridBoxDimensions.height)+1)*p.gridBoxDimensions.height;if(a>0){v.style.left=c.pageX+25+"px";y.innerText=a;t.style.width=a+"px"}if(b>0){v.style.top=c.pageY+25+"px";z.innerText=b;t.style.height=b+"px"}};u.querySelector("u").innerText="bottom right";T(u.querySelector("table").rows[3]);C[0].removeAttribute("href");C[1].removeAttribute("href");C[0].onclick=C[1].onclick=null};q.onmousemove=function(e){var c=Z(e,q);var a=Math.floor(c.elementY/p.gridBoxDimensions.height)*p.gridBoxDimensions.height;var b=Math.floor(c.elementX/p.gridBoxDimensions.width)*p.gridBoxDimensions.width;t.style.top=a+"px";t.style.left=b+"px";v.style.top=c.pageY+25+"px";v.style.left=c.pageX+25+"px";w.innerText=b;x.innerText=a};bd(q,true);if(l=="Update"){n.className+=" nTileFocus";n.querySelector(".nTileHoverBox").innerText="moving"}else if(l=="New"&&n){n.className+=" nTileFocus";n.querySelector(".nTileHoverBox").innerText="cloning"}document.onkeyup=function(e){if((e||window.event).keyCode==27){D()}};q.style.height=A+500+"px"};R.moveCloneEditOrDeleteTile=function(a,f,g){a.parentNode.style.display="none";R.hover=R.openLink=function(){};var h=S[g];var i=h.tilesWrapper;var j=W("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> on the tile you want to <u>"+f+"</u>.<br /><br />Press <u>escape</u> to cancel."});var k=W("div",document.body,null,{"id":"nTilesToolTip","style":"display: none;","innerHTML":'<b>action&nbsp;: <span>'+f+'</span><br />ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipID"></span></b><br /><br /><br />left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var l=document.getElementById("nTilesToolTipID");var m=document.getElementById("nTilesToolTipLeft");var n=document.getElementById("nTilesToolTipTop");var o=document.getElementById("nTilesToolTipWidth");var p=document.getElementById("nTilesToolTipHeight");R.hover=function(a,b){if(a){b.className+=" nTileFocus";k.style.display="block";l.innerText=b.className.match(/nTile_(\d+)/)[1];m.innerText=b.style.left.replace("px","");n.innerText=b.style.top.replace("px","");o.innerText=b.style.width.replace("px","");p.innerText=b.style.height.replace("px","")}else{k.style.display="none";b.className=b.className.replace(/\ nTileFocus/,"")}};R.openLink=function(c){var d=l.innerText;c.className=c.className.replace(/\ nTileFocus/,"");q();if(f=="Edit"){R.openLink(c,"dialog (refresh tiles after save)",h.siteURL+"/Lists/"+O+"/EditForm.aspx?ID="+d)}else if(f=="Delete"){if(confirm("Are you sure you want to delete the tile?")){be(h.siteURL,f,{"ID":d},function(b){if(b){bc(g,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to delete the tile.")}})}}else{R.addOrMoveTile(a,f,g,c,d)}};var q=function(){document.onkeyup=null;T(j);T(l);T(m);T(n);T(o);T(p);T(k);bd(i,false);R.openLink=bf;R.hover=bg;a.parentNode.style.display=""};bd(i,true,"cell",function(e){var c=Z(e,i);k.style.top=c.pageY+25+"px";k.style.left=c.pageX+25+"px"});document.onkeyup=function(e){if((e||window.event).keyCode==27){q()}}};var bh=W("style",document.head||document.getElementsByTagName('head')[0],{"type":"text/css"});if(bh.styleSheet){bh.styleSheet.cssText=P}else{bh.appendChild(document.createTextNode(P))}return R})();
