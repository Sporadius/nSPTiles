/* nSPTiles 1.0 | https://github.com/imthenachoman/nSPTiles | Copyright (c) 2015 Anchal Nigam | MIT license (http://opensource.org/licenses/mit) */
var nSPTiles=nSPTiles||(function(){"use strict";var W=location.protocol+"//"+location.hostname+(_spPageContextInfo.webServerRelativeUrl==="/"?"":_spPageContextInfo.webServerRelativeUrl)+"/";var X=100;var Y="nSPTiles";var Z=".nTilesWrapper,.nTilesContainer,.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{margin:0;padding:0;overflow:hidden}.nTilesWrapper{position:relative}.nTilesContainer{position:relative;display:inline-block}.nTile,.nTileContentWrapper,.nTileBackground,.nTileHTMLContent{position:absolute;top:0;left:0;bottom:0;right:0}.nTilePositionTable{position:absolute;display:table;width:100%;height:100%}.nTilePositionRow{display:table-row}.nTilePositionCell{display:table-cell;width:100%;height:100%}.nHoverOption1,.nTileHovering .nHoverOption2{display:inline-block!important}.nHoverOption2,.nTileHovering .nHoverOption1{display:none!important}.nTileSliderContent{position:absolute;height:100%;width:100%}.nTileLink{cursor:pointer}.nTileAdminLinks{position:absolute;top:0;right:0;padding:5px;display:none;z-index:50;background-color:#ff9;border:1px solid #000;filter:alpha(opacity=30);opacity:.3}.nTilesWrapper:hover .nTileAdminLinks{display:inline-block}.nTileAdminLinks:hover{filter:(alpha=100);opacity:1}.nTileGridBox{position:absolute;filter:alpha(opacity=30);opacity:.3;background-color:#f00;z-index:100;top:0;left:0}.nTileGridBox.nTileGridBoxClicked{background-color:blue}.nTileOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0f0;filter:alpha(opacity=10);opacity:.1;z-index:95}#nTilesHelp{position:fixed;top:10px;left:10px;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}#nTilesToolTip{font-family:'Lucida Console';position:fixed;top:0;left:0;padding:5px;z-index:999999;background-color:#ffb;border:1px solid #000}.nTileHoverBox{position:absolute;top:0;left:0;width:100%;height:100%;z-index:50;background-color:#ff0;filter:alpha(opacity=50);opacity:.5}.nTileFocus .nTileHoverBox{background-color:#0ff;font-weight:700;text-decoration:underline}#nTilesHelp table{border-collapse:collapse}#nTilesHelp th, #nTilesHelp td{padding:5px}#nTilesHelp th{text-align:right}";var ba=[{DisplayName:"active",Type:"Boolean",Description:"can be used hide a tile without having to remove this entry",Default:"1"},{DisplayName:"tile custom ID",Type:"Text",Description:"custom ID to use for the tile &#xD;&#xA;&#xD;&#xA;default is nTile_[ID] where ID is the ID of the entry in the list",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile custom class(es)",Type:"Text",Description:"custom class(s) to add to the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile width",Type:"Number",Description:"the width of the tile in px",Required:"TRUE",Min:"0",Default:"100",Decimals:"0"},{DisplayName:"tile height",Type:"Number",Description:"the height of the tile in px",Required:"TRUE",Min:"0",Default:"100",Decimals:"0"},{DisplayName:"tile left offset",Type:"Number",Description:"the left offset of the tile in px",Required:"TRUE",Min:"0",Default:"0",Decimals:"0"},{DisplayName:"tile top offset",Type:"Number",Description:"the top offset of the tile in px",Required:"TRUE",Min:"0",Default:"0",Decimals:"0"},{DisplayName:"tile border width",Type:"Number",Description:"the empty space around the tile in px",Required:"TRUE",Min:"0",Decimals:"0",Default:"2"},{DisplayName:"tile zoom on hover",Type:"Boolean",Description:"zoom effect for the tile by making the tile border width 0 when the mouse is over the tile",Required:"FALSE",Default:"1"},{DisplayName:"tile background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",Default:"rgb(0,114,198)",MaxLength:"255"},{DisplayName:"tile background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Default:"none",Choices:100},{DisplayName:"tile background color on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile background opacity on hover",Type:"Choice",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image URL",Type:"Text",Description:"URL of image to use in tile (must be less then 255 characters)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image URL on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile image opacity on hover",Type:"Choice",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile image position",Type:"Choice",Description:"position of the image in the tile",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Default:"top left",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile image width",Type:"Text",Description:"width of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image width]="",AND(ISNUMBER([tile image width]+0),ROUND([tile image width]+0,0)=([tile image width]+0)),AND(RIGHT([tile image width],1)="%",ISNUMBER(LEFT([tile image width],LEN([tile image width])-1)+0)))'}},{DisplayName:"tile image height",Type:"Text",Description:"height of tile image. use just a number to specify in px or end with a % (e.g. 50 or 75%)&#xD;&#xA;&#xD;&#xA;helpful if the image is larger then the icon",Required:"FALSE",MaxLength:"255",Validation:{Message:"Please enter a whole number or a percent.",Function:'=OR([tile image height]="",AND(ISNUMBER([tile image height]+0),ROUND([tile image height]+0,0)=([tile image height]+0)),AND(RIGHT([tile image height],1)="%",ISNUMBER(LEFT([tile image height],LEN([tile image height])-1)+0)))'}},{DisplayName:"tile image padding",Type:"Number",Description:"how far from the edge of the tile should the image be in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"5"},{DisplayName:"tile FA class",Type:"Text",Description:"Font Awesome icon class name",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA style",Type:"Text",Description:"css style to apply to the FA icon",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile FA class on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA color on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA style on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"tile FA opacity on hover",Type:"Choice",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"tile FA position",Type:"Choice",Description:"position of the icon in the tile",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Default:"top left",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"tile FA padding",Type:"Number",Description:"how far from the edge of the tile should the icon be in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"5"},{DisplayName:"tile link type",Type:"Choice",Description:"the type of link to make",Required:"TRUE  ",Format:"Dropdown",FillInChoice:"FALSE",Default:"none",Choices:"none,current window,new window,dialog,dialog (refresh window after save),dialog (refresh tiles after save)"},{DisplayName:"tile Link URL",Type:"Note",Description:"the URL for the link",Required:"FALSE",NumLines:"3",RichText:"FALSE"},{DisplayName:"is heading",Type:"Boolean",Description:"heading tiles have no slider",Default:"0"},{DisplayName:"heading content",Type:"Text",Description:"can use HTML",Required:"FALSE",Default:"heading",MaxLength:"255"},{DisplayName:"heading font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",Default:"white",MaxLength:"255"},{DisplayName:"heading content on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading font color on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"heading position",Type:"Choice",Description:"position of the heading in the tile or slider heading",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Default:"bottom left",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"heading padding",Type:"Number",Description:"padding for the heading in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"5"},{DisplayName:"heading font size",Type:"Number",Description:"font size for the heading in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"10"},{DisplayName:"bold heading",Type:"Boolean",Description:"should the heading text be bold",Default:"1"},{DisplayName:"heading style",Type:"Text",Description:"css style to apply to heading",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider heading height",Type:"Number",Description:"height of the header for the slider in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"25"},{DisplayName:"tile image and FA slider heading push",Type:"Boolean",Description:"if the tile image and/or FA are positioned on the bottom then push them on top of the slider heading",Default:"1"},{DisplayName:"slider body content",Type:"Note",Description:"can use HTML",Required:"FALSE",NumLines:"5",Default:"body",RichText:"FALSE"},{DisplayName:"slider body position",Type:"Choice",Description:"position of the slider body in the slider",Required:"TRUE",Format:"Dropdown",FillInChoice:"FALSE",Default:"top left",Choices:"top left,top center,top right,middle left,middle center,middle right,bottom left,bottom center,bottom right"},{DisplayName:"slider body padding",Type:"Number",Description:"padding of the slider body in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"5"},{DisplayName:"slider body font size",Type:"Number",Description:"font size for the slider body in px",Required:"FALSE",Min:"0",Decimals:"0",Default:"10"},{DisplayName:"slider body font color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",Default:"white",MaxLength:"255"},{DisplayName:"slider body style",Type:"Text",Description:"css style to apply to slider body",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background color",Type:"Text",Description:"HTML/CSS friendly color or .className (e.g.: red, #0099ff, rgb(0,150,255), .color1)",Required:"FALSE",Default:"black",MaxLength:"255"},{DisplayName:"slider background opacity",Type:"Choice",Description:"opacity from 0 (transparent) to 100 (solid)&#xD;&#xA;&#xD;&#xA;leave blank for none",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Default:"50",Choices:100},{DisplayName:"slider background color on hover",Type:"Text",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",MaxLength:"255"},{DisplayName:"slider background opacity on hover",Type:"Choice",Description:"same as above but for when the mouse is over the tile",Required:"FALSE",Format:"Dropdown",FillInChoice:"FALSE",Choices:100},{DisplayName:"cc tile style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("width: ",[tile width],"px; height: ",[tile height],"px; top: ",[tile top offset],"px; left: ",[tile left offset],"px;")'},{DisplayName:"cc tile content wrapper style",Type:"Calculated",ResultType:"Text",Formula:'=CONCATENATE("margin: ",[tile border width],"px;")'},{DisplayName:"cc tile right edge",Type:"Calculated",ResultType:"Number",Decimals:"0",Formula:"=[tile left offset]+[tile width]"},{DisplayName:"cc tile bottom edge",Type:"Calculated",ResultType:"Number",Decimals:"0",Formula:"=[tile top offset]+[tile height]"},{DisplayName:"cc tile background class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]&lt;&gt;"","nTileBackground"&amp;IF([tile background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([tile background color],1)="."," "&amp;REPLACE([tile background color],1,1,""),""),"")'},{DisplayName:"cc tile background style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile background color]&lt;&gt;"",IF(AND([tile background opacity]&lt;&gt;"",[tile background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity]&amp;"); opacity: "&amp;[tile background opacity]/100&amp;"; ","")&amp;IF(AND([tile background color]&lt;&gt;"",LEFT([tile background color],1)&lt;&gt;"."),"background-color: "&amp;[tile background color]&amp;"; ",""),"")'},{DisplayName:"cc tile background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([tile background color on hover],1)="."," "&amp;REPLACE([tile background color on hover],1,1,""),""),"")'},{DisplayName:"cc tile background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile background color]&lt;&gt;"",[tile background color on hover]&lt;&gt;""),IF(AND([tile background opacity on hover]&lt;&gt;"",[tile background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile background opacity on hover]&amp;"); opacity: "&amp;[tile background opacity on hover]/100&amp;"; ","")&amp;IF(AND([tile background color on hover]&lt;&gt;"",LEFT([tile background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[tile background color on hover]&amp;"; ",""),"")'},{DisplayName:"cc tile image and fa table style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image and FA slider heading push],NOT([is heading]),OR([tile image URL]&lt;&gt;"",[tile FA class]&lt;&gt;"")),"height: 0;","")'},{DisplayName:"cc tile image position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"","vertical-align: "&amp;LEFT([tile image position],SEARCH(" ",[tile image position])-1)&amp;"; text-align: "&amp;RIGHT([tile image position],LEN([tile image position])-SEARCH(" ",[tile image position]))&amp;"; "&amp;IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&amp;[tile height]-[tile border width]-[tile border width]-[slider heading height]&amp;"px",""),"")'},{DisplayName:"cc tile image class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"","nTileImage"&amp;IF([tile image URL on hover]&lt;&gt;""," nHoverOption1",""),"")'},{DisplayName:"cc tile image style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile image URL]&lt;&gt;"",IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity]&lt;&gt;"",[tile image opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity]&amp;"); opacity: "&amp;[tile image opacity]/100&amp;"; ",""),"")'},{DisplayName:"cc tile image class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),"nTileImage nHoverOption2","")'},{DisplayName:"cc tile image style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile image URL]&lt;&gt;"",[tile image URL on hover]&lt;&gt;""),IF([tile image width]&lt;&gt;"","width: "&amp;IF(RIGHT([tile image width],1)="%",[tile image width],[tile image width]&amp;"px")&amp;"; ","")&amp;IF([tile image height]&lt;&gt;"","height: "&amp;IF(RIGHT([tile image height],1)="%",[tile image height],[tile image height]&amp;"px")&amp;"; ","")&amp;IF([tile image padding]&lt;&gt;"","padding: "&amp;[tile image padding]&amp;"px; ","")&amp;IF(AND([tile image opacity on hover]&lt;&gt;"",[tile image opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile image opacity on hover]&amp;"); opacity: "&amp;[tile image opacity on hover]/100&amp;"; ",""),"")'},{DisplayName:"cc tile FA position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"","vertical-align: "&amp;LEFT([tile FA position],SEARCH(" ",[tile FA position])-1)&amp;"; text-align: "&amp;RIGHT([tile FA position],LEN([tile FA position])-SEARCH(" ",[tile FA position]))&amp;"; "&amp;IF(AND([tile image and FA slider heading push],NOT([is heading])),"height: "&amp;[tile height]-[tile border width]-[tile border width]-[slider heading height]&amp;"px",""),"")'},{DisplayName:"cc tile FA class",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"","nTileFA fa "&amp;[tile FA class]&amp;IF([tile FA class on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)=".")," "&amp;REPLACE([tile FA color],1,1,""),""),"")'},{DisplayName:"cc tile FA style",Type:"Calculated",ResultType:"Text",Formula:'=IF([tile FA class]&lt;&gt;"",[tile FA style]&amp;"; "&amp;IF(AND([tile FA opacity]&lt;&gt;"",[tile FA opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity]&amp;"); opacity: "&amp;[tile FA opacity]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px; ","")&amp;IF(AND([tile FA color]&lt;&gt;"",LEFT([tile FA color],1)&lt;&gt;"."),"color: "&amp;[tile FA color]&amp;";",""),"")'},{DisplayName:"cc tile FA class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),"nTileFA fa "&amp;[tile FA class on hover]&amp;" nHoverOption2"&amp;IF(AND([tile FA color on hover]&lt;&gt;"",LEFT([tile FA color on hover],1)=".")," "&amp;REPLACE([tile FA color on hover],1,1,""),""),"")'},{DisplayName:"cc tile FA style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([tile FA class]&lt;&gt;"",[tile FA class on hover]&lt;&gt;""),[tile FA style on hover]&amp;"; "&amp;IF(AND([tile FA opacity on hover]&lt;&gt;"",[tile FA opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[tile FA opacity on hover]&amp;"); opacity: "&amp;[tile FA opacity on hover]/100&amp;"; ","")&amp;IF([tile FA padding]&lt;&gt;"","padding: "&amp;[tile FA padding]&amp;"px; ","")&amp;IF(AND([tile FA color on hover]&lt;&gt;"",LEFT([tile FA color on hover],1)&lt;&gt;"."),"color: "&amp;[tile FA color on hover]&amp;";",""),""'},{DisplayName:"cc heading position style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"","vertical-align: "&amp;LEFT([heading position],SEARCH(" ",[heading position])-1)&amp;"; text-align: "&amp;RIGHT([heading position],LEN([heading position])-SEARCH(" ",[heading position]))&amp;"; "&amp;IF(NOT([is heading]),"height: "&amp;[slider heading height]&amp;"px; ",""),"")'},{DisplayName:"cc heading class",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"","nTileHeading"&amp;IF([heading content on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([heading font color])="."," "&amp;REPLACE([heading font color],1,1,""),""),"")'},{DisplayName:"cc heading style",Type:"Calculated",ResultType:"Text",Formula:'=IF([heading content]&lt;&gt;"",[heading style]&amp;"; "&amp;IF([bold heading],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color]&lt;&gt;"",LEFT([heading font color],1)&lt;&gt;"."),"color: "&amp;[heading font color]&amp;"; ",""),"")'},{DisplayName:"cc heading class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),"nTileHeading nHoverOption2"&amp;IF(LEFT([heading font color on hover])="."," "&amp;REPLACE([heading font color on hover],1,1,""),""),"")'},{DisplayName:"cc heading style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND([heading content]&lt;&gt;"",[heading content on hover]&lt;&gt;""),[heading style]&amp;"; "&amp;IF([bold heading],"font-weight: bold; ","")&amp;IF([heading padding]&lt;&gt;"","padding: "&amp;[heading padding]&amp;"px; ","")&amp;IF([heading font size]&lt;&gt;"","font-size: "&amp;[heading font size]&amp;"px; ","")&amp;IF(AND([heading font color on hover]&lt;&gt;"",LEFT([heading font color on hover],1)&lt;&gt;"."),"color: "&amp;[heading font color on hover]&amp;"; ",""),"")'},{DisplayName:"cc slider content style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),CONCATENATE("top: ",[tile height]-[tile border width]-[tile border width]-[slider heading height],"px;"),"")'},{DisplayName:"cc slider position style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"vertical-align: "&amp;LEFT([slider body position],SEARCH(" ",[slider body position])-1)&amp;"; text-align: "&amp;RIGHT([slider body position],LEN([slider body position])-SEARCH(" ",[slider body position]))&amp;"; ","")'},{DisplayName:"cc slider body class",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),"nTileSlider"&amp;IF(LEFT([slider body font color],1)="."," "&amp;REPLACE([slider body font color],1,1,""),""),"")'},{DisplayName:"cc slider body style",Type:"Calculated",ResultType:"Text",Formula:'=IF(NOT([is heading]),[slider body style]&amp;"; "&amp;IF([slider body padding]&lt;&gt;"","padding: "&amp;[slider body padding]&amp;"px; ","")&amp;IF([slider body font size]&lt;&gt;"","font-size: "&amp;[slider body font size]&amp;"px; ","")&amp;IF(AND([slider body font color]&lt;&gt;"",LEFT([slider body font color],1)&lt;&gt;"."),"color: "&amp;[slider body font color]&amp;"; ",""),"")'},{DisplayName:"cc slider background class",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),"nTileBackground"&amp;IF([slider background color on hover]&lt;&gt;""," nHoverOption1","")&amp;IF(LEFT([slider background color],1)="."," "&amp;REPLACE([slider background color],1,1,""),""),"")'},{DisplayName:"cc slider background style",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;""),IF(AND([slider background opacity]&lt;&gt;"",[slider background opacity]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity]&amp;"); opacity: "&amp;[slider background opacity]/100&amp;"; ","")&amp;IF(AND([slider background color]&lt;&gt;"",LEFT([slider background color],1)&lt;&gt;"."),"background-color: "&amp;[slider background color]&amp;"; ",""),"")'},{DisplayName:"cc slider background class on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),"nTileBackground nHoverOption2"&amp;IF(LEFT([slider background color on hover],1)="."," "&amp;REPLACE([slider background color on hover],1,1,""),""),"")'},{DisplayName:"cc slider background style on hover",Type:"Calculated",ResultType:"Text",Formula:'=IF(AND(NOT([is heading]),[slider background color]&lt;&gt;"",[slider background color on hover]&lt;&gt;""),IF(AND([slider background opacity on hover]&lt;&gt;"",[slider background opacity on hover]&lt;&gt;"none"),"filter: alpha(opacity="&amp;[slider background opacity on hover]&amp;"); opacity: "&amp;[slider background opacity on hover]/100&amp;"; ","")&amp;IF(AND([slider background color on hover]&lt;&gt;"",LEFT([slider background color on hover],1)&lt;&gt;"."),"background-color: "&amp;[slider background color on hover]&amp;"; ",""),"")'}];var bb="";var bc={};var bd={};var be=function(){};var bf=function(a){a.parentNode.removeChild(a)};var bg=(function(){var h=0,animationIDTracker={},lastTime=0,vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame']}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(a){var b=new Date().getTime();var c=Math.max(0,16-(b-lastTime));var d=window.setTimeout(function(){a(b+c)},c);lastTime=b+c;return d}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(a){clearTimeout(a)}}return{stop:function(a){cancelAnimationFrame(animationIDTracker[a]);delete animationIDTracker[a]},start:function(b,c,d){var e=h++;var f=+new Date();var g=function(){var a=+new Date()-f;if(a>=b){c(1);bg.stop(e)}else{c(bh[d](a,0,1,b));animationIDTracker[e]=requestAnimationFrame(g)}};g();return e}}})();var bh={slide:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},bounce:function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}},elastic:function(t,b,c,d){var s=1.70158;var p=0;var a=c;if(t===0)return b;if((t/=d)==1)return b+c;if(!p)p=d*0.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b}};var bi=function(a,b,c,d){var e=document.createElement(a);if(c){e.className=c}if(d){for(var f in d){if(/^(inner|on)\w+$/i.test(f)){e[f]=d[f]}else{e.setAttribute(f,d[f])}}}if(b){b.appendChild(e)}return e};var bj=function(a,b,c,d,e){var f=typeof XMLHttpRequest!='undefined'?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');f.open("post",W+"_vti_bin/"+a,typeof(e)!=="undefined"&&e!==null?e:false);f.setRequestHeader("SOAPAction",b);f.setRequestHeader("Content-Type","text/xml; charset=\"utf-8\"");f.onreadystatechange=function(){if(f.readyState==4){d(f.status==200,f)}};f.send('<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body>'+c+'</soap:Body></soap:Envelope>')};var bk=function(a,b,c){var d=a.getElementsByTagName(b);if(!d.length){d=a.getElementsByTagName(c+":"+b)}return d};var bl=function(e,a){var c={"e":e||window.event,"pageX":0,"pageY":0,"elementX":0,"elementY":0};if(c.e.pageX||c.e.pageY){c.pageX=c.e.pageX;c.pageY=c.e.pageY}else if(c.e.clientX||c.e.clientY){c.pageX=c.e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c.pageY=c.e.clientY+document.body.scrollTop+document.documentElement.scrollTop}if(a){var b=a.getBoundingClientRect();c.elementX=c.pageX-b.left;c.elementY=c.pageY-b.top}return c};var bm=function(a,b,c,d,e,f){var g='<div class="nTilePositionTable '+a+'" style="'+b+'">';g+='<div class="nTilePositionRow nTilePositionRow1"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+c+';">'+d+'</div></div>';if(e){g+='<div class="nTilePositionRow nTilePositionRow2"><div class="nTilePositionCell" style="width: 100%; height: 100%;'+e+'">'+f+'</div></div>'}return g+'</div>'};var bn=function(O,P,Q){var R=bd[O];R.tiles={};var S=R.tilesWrapper;var T=S.querySelector(".nTilesContainer");var U=T.querySelectorAll(".nTile");for(var i=0,num=U.length;i<num;++i){U[i].onclick=U[i].onmouseenter=U[i].onmouseleave=null}T.innerText="Please wait while I reload the data...";if(bb===""){bb='<FieldRef Name="ID" />';for(var i=0,num=ba.length;i<num;++i){bb+='<FieldRef Name="'+"n"+ba[i].DisplayName.replace(/\b\w/g,function(m){return m.toUpperCase()}).replace(/[^a-zA-Z]/g,"")+'" />'}}var V='';V+='<GetListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';V+='<listName>'+Y+'</listName>';V+='<query><Query><Where><And><Eq><FieldRef Name="Title"/><Value Type="Text">'+R.groupName+'</Value></Eq><Eq><FieldRef Name="nActive"/><Value Type="Boolean">1</Value></Eq></And></Where></Query></query>';V+='<viewFields><ViewFields>'+bb+'</ViewFields></viewFields>';V+='<rowLimit>0</rowLimit>';V+='</GetListItems>';bj("Lists.asmx?op=GetListItems","http://schemas.microsoft.com/sharepoint/soap/GetListItems",V,function(a,b){var c=b.responseXML;if(!a){if(Q){Q(bk(c,"errorcode")[0].childNodes[0].nodeValue=="0x82000006"?2:3)}return}var d=bk(c,"row","z");var e="";var f=100;var g=100;if(d.length){var h=-1;var j=-1;for(var i=0,num=d.length;i<num;++i){var k="";var l=d[i];var m=l.getAttribute("ows_ID");var n=parseInt(l.getAttribute("ows_nCcTileRightEdge").replace(/^[a-z]*?;#/i,""),10);var o=parseInt(l.getAttribute("ows_nCcTileBottomEdge").replace(/^[a-z]*?;#/i,""),10);var p=l.getAttribute("ows_nTileZoomOnHover");var q=l.getAttribute("ows_nTileLinkType");var r=l.getAttribute("ows_nTileImageURL");var s=l.getAttribute("ows_nTileImageURLOnHover")?l.getAttribute("ows_nTileImageURLOnHover"):l.getAttribute("ows_nTileImageURLOnHover");var t=l.getAttribute("ows_nIsHeading");var u=l.getAttribute("ows_nHeadingContent");var v=l.getAttribute("ows_nHeadingContentOnHover");var w=l.getAttribute("ows_nCcTileBackgroundClass").replace(/^[a-z]*?;#/i,"");var x=l.getAttribute("ows_nCcTileBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var y=l.getAttribute("ows_nCcTileFAClass").replace(/^[a-z]*?;#/i,"");var z=l.getAttribute("ows_nCcTileFAClassOnHover").replace(/^[a-z]*?;#/i,"");var A=l.getAttribute("ows_nCcHeadingPositionStyle").replace(/^[a-z]*?;#/i,"");var B=l.getAttribute("ows_nCcHeadingClass").replace(/^[a-z]*?;#/i,"");var C=l.getAttribute("ows_nCcHeadingStyle").replace(/^[a-z]*?;#/i,"");var D=l.getAttribute("ows_nCcHeadingClassOnHover").replace(/^[a-z]*?;#/i,"");var E=l.getAttribute("ows_nCcHeadingStyleOnHover").replace(/^[a-z]*?;#/i,"");var F=l.getAttribute("ows_nCcSliderBackgroundClass").replace(/^[a-z]*?;#/i,"");var G=l.getAttribute("ows_nCcSliderBackgroundClassOnHover").replace(/^[a-z]*?;#/i,"");var H=(l.getAttribute("ows_nTileCustomClassEs")||"")+" nTile nTile_"+m;var I="nSPTiles.hover(true, this, '"+O+"', "+m+", '"+t+"', '"+p+"')";var J="nSPTiles.hover(false, this, '"+O+"', "+m+", '"+t+"', '"+p+"')";if(q!="none"){H+=" nTileLink"}var K="nSPTiles.openLink(this, '"+q+"', '"+(l.getAttribute("ows_nTileLinkURL")?l.getAttribute("ows_nTileLinkURL").replace(/\s|\r|\n/g,""):l.getAttribute("ows_nTileLinkURL"))+"')";if(h<n){h=n}if(j<o){j=o}k+='<div class="nTileContentWrapper" style="'+l.getAttribute("ows_nCcTileContentWrapperStyle").replace(/^[a-z]*?;#/i,"")+'">';if(w){k+='<div class="'+w+'" style="'+(l.getAttribute("ows_nCcTileBackgroundStyle").replace(/^[a-z]*?;#/i,""))+'"></div>';if(x){k+='<div class="'+x+'" style="'+(l.getAttribute("ows_nCcTileBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></div>'}}if(r){var L='<img class="'+(l.getAttribute("ows_nCcTileImageClass").replace(/^[a-z]*?;#/i,""))+'" style="'+(l.getAttribute("ows_nCcTileImageStyle").replace(/^[a-z]*?;#/i,""))+'" src="'+r+'" />';if(s){L+='<img class="'+(l.getAttribute("ows_nCcTileImageClassOnHover").replace(/^[a-z]*?;#/i,""))+'" style="'+(l.getAttribute("ows_nCcTileImageStyleOnHover").replace(/^[a-z]*?;#/i,""))+'" src="'+s+'" />'}k+=bm("nTileImagePositionWrapper",(l.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,"")),(l.getAttribute("ows_nCcTileImagePositionStyle").replace(/^[a-z]*?;#/i,"")),'<div style="line-height: 0;">'+L+'</div>')}if(y){var L='<span class="'+y+'" style="'+(l.getAttribute("ows_nCcTileFAStyle").replace(/^[a-z]*?;#/i,""))+'"></span>';if(z){L+='<span class="'+z+'" style="'+(l.getAttribute("ows_nCcTileFAStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></span>'}k+=bm("nTileFAPositionWrapper",(l.getAttribute("ows_nCcTileImageAndFaTableStyle").replace(/^[a-z]*?;#/i,"")),(l.getAttribute("ows_nCcTileFAPositionStyle").replace(/^[a-z]*?;#/i,"")),L)}if(t=="1"){H+=" nHeadingTile";var L='<div class="'+B+'" style="'+C+'">'+(u||"")+'</div>';if(v){L+='<div class="'+D+'" style="'+E+'">'+(v||"")+'</div>'}k+=bm("nTileHeadingPositionWrapper","",A,L)}else{H+=" nSliderTile";k+='<div class="nTileSliderContent" style="'+(l.getAttribute("ows_nCcSliderContentStyle").replace(/^[a-z]*?;#/i,""))+'">';if(F){k+='<div class="'+F+'" style="'+(l.getAttribute("ows_nCcSliderBackgroundStyle").replace(/^[a-z]*?;#/i,""))+'"></div>';if(G){k+='<div class="'+G+'" style="'+(l.getAttribute("ows_nCcSliderBackgroundStyleOnHover").replace(/^[a-z]*?;#/i,""))+'"></div>'}}var M='<div class="'+B+'" style="'+C+'">'+(u||"")+'</div>';if(v){M+='<div class="'+D+'" style="'+E+'">'+(v||"")+'</div>'}var N='<div class="'+(l.getAttribute("ows_nCcSliderBodyClass").replace(/^[a-z]*?;#/i,""))+'" style="'+(l.getAttribute("ows_nCcSliderBodyStyle").replace(/^[a-z]*?;#/i,""))+'">'+(l.getAttribute("ows_nSliderBodyContent"))+'</div>';k+=bm("nTileSliderPositionWrapper","",A,M,(l.getAttribute("ows_nCcSliderPositionStyle").replace(/^[a-z]*?;#/i,"")),N);k+='</div>'}k+='</div>';e+='<div id="'+(l.getAttribute("ows_nTileCustomID")||"nTile_"+m)+'" class="'+H+'" style="'+l.getAttribute("ows_nCcTileStyle").replace(/^[a-z]*?;#/i,"")+'" onmouseenter="'+I+'" onmouseleave="'+J+'" onclick="'+K+'">'+k+'</div>'}f=h;g=j;T.innerHTML=e}else{T.innerHTML=""}S.style.height=g+"px";T.style.height=g+"px";T.style.width=f+"px";if(Q){Q(0)}},P)};var bo=function(a,b,c,d){if(b){var e=a.querySelectorAll(".nTile");var f=bi("div",null,"nTileHoverBox",{"style":"text-align: center;","innerText":"tile"});if(c){f.style.cursor=c}for(var i=0,num=e.length;i<num;++i){var g=e[i];var h=f.cloneNode(true);h.style.lineHeight=g.style.height;if(d){h.onmousemove=d}g.appendChild(h)}}else{var j=a.querySelectorAll(".nTileHoverBox");for(var i=0,num=j.length;i<num;++i){var f=j[i];f.onmousemove=null;bf(f)}}};var bp=function(a,b,c){var d='<UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/">';d+='<listName>'+Y+'</listName>';d+='<updates>';d+='<Batch OnError="Continue">';d+='<Method ID="1" Cmd="'+a+'">';for(var i in b){if(b.hasOwnProperty(i)){d+='<Field Name="'+i+'">'+b[i]+'</Field>'}}d+='</Method>';d+='</Batch>';d+='</updates>';d+='</UpdateListItems>';bj("Lists.asmx?op=UpdateListItems","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems",d,c,true)};var bq=bc.openLink=function(b,c,d){var e={"url":d};switch(c){case"none":break;case"current window":location.href=d;break;case"new window":window.open(d);break;case"dialog":SP.UI.ModalDialog.showModalDialog(e);break;case"dialog (refresh window after save)":e.dialogReturnValueCallback=function(a){if(a==SP.UI.DialogResult.OK){location.href=location.href}};SP.UI.ModalDialog.showModalDialog(e);break;case"dialog (refresh tiles after save)":e.dialogReturnValueCallback=function(a){if(a==SP.UI.DialogResult.OK){bn(b.parentNode.parentNode.id,true)}};SP.UI.ModalDialog.showModalDialog(e);break;default:alert("I don't know how to handle open a link of type '"+c+"'.");break}};var br=bc.hover=function(b,c,d,e,f,g){var h=bd[d];var i=h.tiles[c.id]=h.tiles[c.id]||{};if(b){c.className+=" nTileHovering"}else{c.className=c.className.replace(/\ nTileHovering/,"")}if("animationID"in i){bg.stop(i.animationID)}if(g==="Yes"||g==="1"){var j=c.querySelector(".nTileContentWrapper");var k=i.margin=i.margin||parseInt(j.style.margin.replace("px",""),10);var l=parseInt(j.style.margin.replace("px",""),10);var m=b?0:k;var n=m-l}if(f!=="Yes"&&f!=="1"){var o=c.querySelector(".nTileSliderContent");var p=i.top=i.top||parseInt(o.style.top.replace("px",""),10);var q=parseInt(o.style.top.replace("px",""),10);var r=b?0:p;var s=r-q}if(g==="Yes"||g==="1"||f!=="Yes"&&f!=="1"){i.animationID=bg.start(b?h.animationTime:(h.animationTime<500?h.animationTime*2:1000),function(a){if(j){j.style.margin=l+(a*n)+"px"}if(o){o.style.top=q+(a*s)+"px"}},b?h.animationTypeOn:h.animationTypeOff)}};bc.setup=function(a,b,c){c=c||{};bd[a]={holderID:a,groupName:b,animationTime:parseInt(c.animationTime,10)||X,animationTypeOn:c.animationTypeOn&&c.animationTypeOn in bh&&c.animationTypeOn||"slide",animationTypeOff:c.animationTypeOff&&c.animationTypeOff in bh&&c.animationTypeOff||"bounce",tilesWrapper:document.getElementById(a),gridBoxDimensions:{width:25,height:25},tiles:{}}};bc.init=function(h,k,l){var n=document.getElementById(h);if(n){bc.setup(h,k,l);n.className+=(n.className?" ":"")+"nTilesWrapper";n.innerHTML='<div class="nTilesContainer">Loading...</div>';bn(h,false,function(g){if(g==2){n.innerHTML="List '"+Y+"' does not exist. Click <a href='#'>here</a> to create it.";n.querySelector("a").onclick=function(){var f='';f+='<AddList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+Y+'</listName>';f+='<description>List used to house tile configuration for nTiles.</description>';f+='<templateID>100</templateID>';f+='</AddList>';bj("Lists.asmx?op=AddList","http://schemas.microsoft.com/sharepoint/soap/AddList",f,function(e){if(!e){n.innerHTML="Unable to create the list."}else{n.innerHTML="List '"+Y+"' created. Updating list...";setTimeout(function(){f='';f+='<UpdateList xmlns="http://schemas.microsoft.com/sharepoint/soap/">';f+='<listName>'+Y+'</listName>';f+='<listProperties>';f+='<List EnableAttachments="FALSE" OnQuickLaunch="TRUE" Description="List used to house tile configuration for nTiles. (v1.0)" />';f+='</listProperties>';f+='<newFields>';f+='<Fields>';for(var i=0,num=ba.length;i<num;++i){var c=ba[i];c.Name="n"+c.DisplayName.replace(/\b\w/g,function(m){return m.toUpperCase()}).replace(/[^a-zA-Z]/g,"");f+='<Method ID="'+(i+2)+'"'+(c.Type!="Calculated"?' AddToView=""':'')+'><Field Type="'+c.Type+'" DisplayName="'+c.Name+'" '+(c.Type=="Calculated"?'ResultType="'+c.ReturnType+'"><Formula>=1</Formula></Field>':'/>')+'</Method>'}f+='</Fields>';f+='</newFields>';f+='<updateFields>';f+='<Fields>';f+='<Method ID="1">';f+='<Field Type="Text" Name="Title" DisplayName="group name" Required="TRUE" Description="the name of the group this tile belongs to"/>';f+='</Method>';for(var i=0,num=ba.length;i<num;++i){var c=ba[i];f+='<Method ID="'+(ba.length+i+2)+'"><Field Type="'+c.Type+'" Name="'+c.Name+'"';for(var d in c){if(c.hasOwnProperty(d)){if(d=="Type"||d=="Name"||d=="Default"||d=="Validation"||d=="Choices"||d=="Formula"){continue}f+=' '+d+'="'+c[d]+'"'}}f+='>';if(c.hasOwnProperty("Formula")){f+='<Formula>'+c.Formula+'</Formula>'}if(c.hasOwnProperty("Default")){f+='<Default>'+c.Default+'</Default>'}if(c.hasOwnProperty("Validation")){f+='<Validation Message="'+c.Validation.Message+'">'+c.Validation.Function+'</Validation>'}if(c.hasOwnProperty("Choices")){f+='<CHOICES>';if(typeof(c.Choices)==="number"){f+='<CHOICE>none</CHOICE>';for(var j=0;j<=c.Choices;++j){f+='<CHOICE>'+j+'</CHOICE>'}}else{f+='<CHOICE>'+c.Choices.split(",").join('</CHOICE><CHOICE>')+'</CHOICE>'}f+='</CHOICES>'}f+='</Field></Method>'}f+='</Fields>';f+='</updateFields>';f+='</UpdateList>';bj("Lists.asmx?op=UpdateList","http://schemas.microsoft.com/sharepoint/soap/UpdateList",f,function(a,b){if(a){alert("Finished creating and updating the list.\nReloading the page.\nHappy tiling!");location.reload()}else{n.innerHTML="Unable to add fields to the list."}})},1)}});return false}}else if(g==3){alert("unknown error")}else if(g===0){ExecuteOrDelayUntilScriptLoaded(function(){var a=new SP.ClientContext.get_current();var b=a.get_web().get_lists().getByTitle(Y);a.load(b);a.load(b,'EffectiveBasePermissions');a.executeQueryAsync(Function.createDelegate(this,function(){if(b.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)){bi("span",n,"nTileAdminLinks",{"innerHTML":'<b>actions</b>:&nbsp;<a href="#" title="add a tile" onclick="nSPTiles.startAddOrMoveTile(this, \'New\', \''+h+'\'); return false;">add</a>&nbsp;|&nbsp;<a href="#" title="move a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Update\', \''+h+'\'); return false;">move</a>&nbsp;|&nbsp;<a href="#" title="edit a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Edit\', \''+h+'\'); return false;">edit</a>&nbsp;|&nbsp;<a href="#" title="delete a tile" onclick="nSPTiles.startTilesMoveEditDelete(this, \'Delete\', \''+h+'\'); return false;">delete</a>&nbsp;|&nbsp;<a target="_blank" href="'+W+'Lists/'+Y+'">list</a>'})}}),Function.createDelegate(this,function(){}))},"sp.js")}})}else if(document.readyState=="complete"){alert("An element with the ID '"+h+"' was not found.")}else{if(document.addEventListener){document.addEventListener('DOMContentLoaded',function(){bc.init(h,k,l)})}else{document.attachEvent('onreadystatechange',function(){if(document.readyState!='loading'){bc.init(h,k,l)}})}}};bc.startAddOrMoveTile=function(a,h,i,j,k){a.parentNode.style.display="none";var l=bd[i];var m=l.tilesWrapper;var n=bi("div",m,"nTileOverlay");var o=bi("div",m,"nTileGridBox",{"style":"width: "+l.gridBoxDimensions.width+"px; height: "+l.gridBoxDimensions.height+"px;"});var p=bi("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> where you want the <u>top left</u> of the tile to be.<br /><br /><table><tr><td colspan='2'>box dimensions:</td></tr><tr><th>width</th><td><a href='#'>"+l.gridBoxDimensions.width+"</a></td></tr><tr><th>height</th><td><a href='#'>"+l.gridBoxDimensions.height+"</a></td></tr><tr><td colspan='2'>click on the # to change</td></tr></table><br />Press <u>escape</u> to cancel."});var q=bi("div",document.body,null,{"id":"nTilesToolTip","innerHTML":'left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var r=document.getElementById("nTilesToolTipLeft");var s=document.getElementById("nTilesToolTipTop");var t=document.getElementById("nTilesToolTipWidth");var u=document.getElementById("nTilesToolTipHeight");var v=m.offsetHeight;var w=function(a,b){var c=prompt("Please enter a new "+b+":",l.gridBoxDimensions[b]);if(c===null)return;if(isNaN(c)){alert("Please enter a valid number.");w(a,b)}else{l.gridBoxDimensions[b]=parseInt(c,10);a.innerText=l.gridBoxDimensions[b];o.style[b]=l.gridBoxDimensions[b]+"px"}return false};var x=p.querySelectorAll("a");x[0].onclick=function(){w(this,"width")};x[1].onclick=function(){w(this,"height")};var y=function(){document.onkeyup=x[0].onclick=x[1].onclick=o.onclick=m.onmousemove=null;bf(x[0]);bf(x[1]);bf(n);bf(o);bf(p);bf(r);bf(s);bf(t);bf(u);bf(q);bo(m,false);if(j){j.className=j.className.replace(/\ nTileFocus/,"")}m.style.height=v;a.parentNode.style.display=""};o.onclick=function(){o.className+=" nTileGridBoxClicked";var f=r.innerText;var g=s.innerText;o.onclick=function(){var c=t.innerText;var d=u.innerText;bp(h,{"ID":h=="New"?"New":k,"Title":l.groupName,"nTileWidth":c,"nTileHeight":d,"nTileLeftOffset":f,"nTileTopOffset":g},function(b){y();if(b){bn(i,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to "+(h=="New"?"add a new":"update existing")+" tile.")}})};m.onmousemove=function(e){var c=bl(e,m);var a=(Math.floor((c.elementX-f)/l.gridBoxDimensions.width)+1)*l.gridBoxDimensions.width;var b=(Math.floor((c.elementY-g)/l.gridBoxDimensions.height)+1)*l.gridBoxDimensions.height;if(a>0){q.style.left=c.pageX+25+"px";t.innerText=a;o.style.width=a+"px"}if(b>0){q.style.top=c.pageY+25+"px";u.innerText=b;o.style.height=b+"px"}};p.querySelector("u").innerText="bottom right";bf(p.querySelector("table").rows[3]);x[0].removeAttribute("href");x[1].removeAttribute("href");x[0].onclick=x[1].onclick=null};m.onmousemove=function(e){var c=bl(e,m);var a=Math.floor(c.elementY/l.gridBoxDimensions.height)*l.gridBoxDimensions.height;var b=Math.floor(c.elementX/l.gridBoxDimensions.width)*l.gridBoxDimensions.width;o.style.top=a+"px";o.style.left=b+"px";q.style.top=c.pageY+25+"px";q.style.left=c.pageX+25+"px";r.innerText=b;s.innerText=a};bo(m,true);if(h=="Update"){j.className+=" nTileFocus";j.querySelector(".nTileHoverBox").innerText="moving"}document.onkeyup=function(e){if((e||window.event).keyCode==27){y()}};m.style.height=v+500+"px"};bc.startTilesMoveEditDelete=function(a,f,g){a.parentNode.style.display="none";bc.hover=bc.openLink=be;var h=bd[g];var i=h.tilesWrapper;var j=bi("div",document.body,null,{"id":"nTilesHelp","innerHTML":"<b>Click</b> on the tile you want to <u>"+f+"</u>.<br /><br />Press <u>escape</u> to cancel."});var k=bi("div",document.body,null,{"id":"nTilesToolTip","style":"display: none;","innerHTML":'<b>action&nbsp;: <span>'+f+'</span><br />ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipID"></span></b><br /><br /><br />left&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipLeft"></span><br />top&nbsp;&nbsp;&nbsp;&nbsp;: <span id="nTilesToolTipTop"></span><br />--<br />width&nbsp;&nbsp;: <span id="nTilesToolTipWidth"></span><br />height&nbsp;: <span id="nTilesToolTipHeight"></span>'});var l=document.getElementById("nTilesToolTipID");var m=document.getElementById("nTilesToolTipLeft");var n=document.getElementById("nTilesToolTipTop");var o=document.getElementById("nTilesToolTipWidth");var p=document.getElementById("nTilesToolTipHeight");bc.hover=function(a,b,c,d){if(a){b.className+=" nTileFocus";k.style.display="block";l.innerText=d;m.innerText=b.style.left.replace("px","");n.innerText=b.style.top.replace("px","");o.innerText=b.style.width.replace("px","");p.innerText=b.style.height.replace("px","")}else{k.style.display="none";b.className=b.className.replace(/\ nTileFocus/,"")}};bc.openLink=function(c){var d=l.innerText;c.className=c.className.replace(/\ nTileFocus/,"");q();if(f=="Edit"){bc.openLink(c,"dialog (refresh tiles after save)",W+"Lists/"+Y+"/EditForm.aspx?ID="+d)}else if(f=="Delete"){if(confirm("Are you sure you want to delete the tile?")){bp(f,{"ID":d},function(b){if(b){bn(g,true,function(a){if(a!==0){alert("There was an error reloading the data which is odd cause it worked on loading.")}})}else{alert("Unable to delete the tile.")}})}}else{bc.startAddOrMoveTile(a,f,g,c,d)}};var q=function(){document.onkeyup=null;bf(j);bf(l);bf(m);bf(n);bf(o);bf(p);bf(k);bo(i,false);bc.openLink=bq;bc.hover=br;a.parentNode.style.display=""};bo(i,true,f=="Update"?"move":"context-menu",function(e){var c=bl(e,i);k.style.top=c.pageY+25+"px";k.style.left=c.pageX+25+"px"});document.onkeyup=function(e){if((e||window.event).keyCode==27){q()}}};var bs=bi("style",document.head||document.getElementsByTagName('head')[0],{"type":"text/css"});if(bs.styleSheet){bs.styleSheet.cssText=Z}else{bs.appendChild(document.createTextNode(Z))}return bc})();
